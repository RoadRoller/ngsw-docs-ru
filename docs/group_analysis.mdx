---
sidebar_position: 10
sidebar_label: Групповой анализ
---

# Групповой анализ

Раздел "Групповой анализ" позволяет провести анализ герминальной когорты и представляет из себя
объединение герминальных вариантов (SNVs/Indels), выявленных в выбранных для анализа образцах.
Обычно групповой анализ используется для объединения и сравнения образцов пациентов, схожих по
какому-либо признаку (например, по типу патологии или источнику данных).
Групповой анализ включает комбинирование, фильтрацию и аннотацию герминальных вариантов образцов.

Чтобы открыть страницу с групповыми анализами, перейдите на страницу "**Все анализы**" из блока
страниц "**Групповой анализ**" через панель навигации слева:

<p align="center">
<img src={require('/img/group_analysis/group_analysis_page.png').default} width="900"/>
</p>

### Создание группового анализа

Для перехода к форме создания группового анализа нажмите
на <img src={require('/img/rus/add_group_analysis_btn.png').default} width="150"/>.
Другим путем создания группового анализа является [объединение когорты](/cohorts#групповой-анализ-когорты).

В открывшейся форме введите название группового анализа в поле **Имя**.
Если хотите, можете также добавить описание анализа.

<p align="center">
<img src={require('/img/group_analysis/create_group_analysis.png').default} height="600"/>
</p>

#### Настройки анализа

Если вы хотите использовать вашу предустановку настроек параметров фильтрации герминальных SNVs/Indels,
выберите её в выпадающем списке "Предварительной установки настроек". Обратите внимание, что на ход
группового анализа может повлиять только такая предустановка, которая настраивает
параметры фильтрации герминальных SNVs/Indels. Если выбранные по умолчанию параметры фильтрации вас устраивают,
оставьте для анализа предустановку, выбранную по дефолту.

#### Образцы для анализа

Внизу формы находится таблица с образцами, для которых можно провести групповой анализ. Таблица включает
название образца и код пациента, к которому он относится. Образец неопухолевой ткани
обозначен как <img src={require('/img/rus/normal_success.png').default} width="20"/>, образец
опухолевой ткани - <img src={require('/img/rus/tumor_success.png').default} width="20"/>.
Для группового анализа доступны только образцы,
загруженные в формате FASTQ или BAM, для которых была успешно завершена стадия выявления герминальных
SNV/Indels и которые принадлежат пациенту, не находящемуся в "Архиве".
Отметьте галочкой те образцы (минимум два), для которых вы хотите провести анализ.

#### Запуск анализа

После добавления всех образцов нажмите <img src={require('/img/rus/create_btn.png').default} width="130"/>
для запуска анализа:

<p align="center">
<img src={require('/img/group_analysis/all_chosen.png').default} height="600"/>
</p>

### Страница группового анализа

Сразу после старта анализа вы попадете на его страницу (вкладка "**Главное**"):

<p align="center">
<img src={require('/img/group_analysis/ga_page.png').default} width="900"/>
</p>

На странице отображена информация о процессе анализа и об анализе и, когда анализ будет успешно завершен,
здесь появятся основные результаты.

#### Информация о групповом анализе

Справа на странице отображена основная информация об анализе:

<p align="center">
<img src={require('/img/group_analysis/ga_info.png').default} width="900"/>
</p>

- ИМЯ - название группового анализа. Можно поменять, нажав на поле значения.
- СОЗДАН - дата создания группового анализа в формате м/д/гггг.
- ТИП АНАЛИЗА - соответствует типу вариантов, для которых проводится анализ - герминальных (Герминальная когорта).
- ОБРАЗЦЫ - список образцов, для которых проводился анализ. Нажав на название образца, можно открыть его страницу.
- КОММЕНТАРИИ - можно указать, нажав на поле значения.

### Процесс анализа

На вкладке "Главное" страницы группового анализа представлен раздел с информацией о процессе анализа.
Раздел представляет из себя таблицу со стадиями анализа и их статусами.

<p align="center">
<img src={require('/img/group_analysis/workflow.png').default} width="900"/>
</p>

- Если стадия находится в процессе выполнения, то в её статусе есть
значок <img src={require('/img/results/in_process.png').default} width="22"/> и процентое
значение прогресса её выполнения.
- Если стадия завершена успешно, то она
имеет статус <img src={require('/img/results/complete.png').default} width="100"/>.
- Если стадия завершена с ошибкой, то в её статусе есть
значок <img src={require('/img/results/failed.png').default} width="25"/> и указана конкретная задача, на которой
анализ прекратился. В таком случае можно сообщить о возникшей проблеме администратору, нажав
на <img src={require('/img/results/report_a_problem.png').default} width="25"/>, или
попробовать повторить выполнение задачи, нажав на <img src={require('/img/results/try_again.png').default} width="22"/>.
- Если ещё не выполнены предыдующие шаги анализа, то стадия находится в статусе "Не начато".

Для каждой стадии можно посмотреть её детали, нажав
на <img src={require('/img/results/show_details.png').default} width="25"/>. Тогда вы перейдете в раздел этой стадии
на вкладке "**Детали процесса анализа**". На этой вкладке для каждой стадии можно скачать файлы с результатами и
посмотреть технические детали, такие как вывод консоли и сообщение об ошибке при обработке, если такая возникла.

#### Стадии группового анализа:

1. Комбинирование герминальных SNV/Indels - слияние файлов gVCF, полученных в результате выявления герминальных
SNVs/Indels в образцах, с помощью инструмента GATK CombineGVCFs;
2. Совместное генотипирование образцов анализа с помощью инструмента GATK GenotypeGVCFs;
3. Фильтрация герминальных SNV/Indels - фильтрация вариантов с помощью инструмента GATK VariantFiltration на
основе определенных критериев фильтрации, которые вы можете найти и поменять на вкладке "Параметры" на
странице группового анализа;
4. Нормализация герминальных SNV/Indels - выравнивание варианта по левому краю, нормализация инделов, проверка того,
что референсные аллели (REF) совпадают с референсом, разделение мультиаллельных вариантов и инделов на биаллельные
записи, удаление дубликатов с помощью инструмента Bcftools norm;
5. Аннотация герминальных SNV/Indels - определение влияния вариантов на различные участки ДНК с помощью инструмента
VEP и набора инструментов, разработанного командой Genomenal;
6. Загрузка проаннотированных вариантов.

#### Перезапуск анализа

Если вы хотите перезапустить выполнение одной из завершенных стадий, наведите курсор мыши на строку стадии
и нажмите на появившийся элемент <img src={require('/img/results/try_again.png').default} width="20"/>.

Если вы хотите перезапустить анализ с самого начала (со стадии "Комбинирование герминальных SNV/Indels"),
нажмите на кнопку <img src={require('/img/results/restart_analysis.png').default} width="180"/>.
Обратите внимание, что такая кнопка есть только у анализа, все стадии которого завершились успешно.

### Результаты анализа

После успешного завершения всех стадий анализа результаты появятся на странице группового анализа:

1. Секция "***Герминальные SNV/Indels***" на вкладке "Главное" включает все основные результаты группового
анализа:

<p align="center">
<img src={require('/img/results/germline_snvs.png').default} width="800"/>
</p>

- **Variant Viewer** - встроенный модуль для просмотра и анализа вариантов. Подробно описан
в [соответствующем разделе](/results/main/snvs_indels/variant-viewer). Нажмите
на кнопку <img src={require('/img/results/vv_btn.png').default} width="120"/>, чтобы воспользоваться модулем.
- Текстовый файл в формате **CSV** (Comma-Separated Values). Чтобы скачать файл,
нажмите на <img src={require('/img/results/table_btn.png').default} width="90"/>.
- Файл в формате **[VCF 4.2 (Variant Call Format)](http://samtools.github.io/hts-specs/VCFv4.2.pdf)**.
Чтобы скачать файл, нажмите на <img src={require('/img/results/vcf_btn.png').default} width="45"/>.
- Файл в **таблицах Google** (может быть показана только часть вариантов). Чтобы открыть файл, нажмите
на <img src={require('/img/results/google_btn.png').default} width="45"/>.
- **[Integrative Genomics Viewer (IGV)](https://software.broadinstitute.org/software/igv/)** - встроенный модуль
визуализации вариаций на геноме. Чтобы открыть модуль, нажмите
на <img src={require('/img/results/igv_btn.png').default} width="45"/>.

2. ***Отчет по герминальным SNV/Indels образца неопухолевой ткани*** на вкладке "Биоинформатический отчет".
Отчет представляет из себя три таблицы:
- Количество герминальных вариантов, оставшихся в результате анализа: данные о количестве всех вариантов,
однонуклеотидных вариантов (SNV) и коротких инсерций/делеций (Indel);
- Позиция в геноме: количество вариантов в экзонах (exonic), интронах (intronic), межгенной области (intergenic),
сайтах сплайсинга (in splice site), некодирующих областях (in non-protein-coding transcript);
- Известные варианты: количество вариантов, входящих в базы данных [dbSNP](https://www.ncbi.nlm.nih.gov/snp/),
[1000 Genomes](https://www.internationalgenome.org/home), [gnomAD](https://gnomad.broadinstitute.org/),
[ClinVar](https://www.ncbi.nlm.nih.gov/clinvar/), [dbNSFP](https://sites.google.com/site/jpopgen/dbNSFP).

Чтобы экспортировать отчет в формате PDF,
нажмите на кнопку <img src={require('/img/results/export_pdf.png').default} width="150"/>.

3. Результирующие файлы для каждой стадии анализа на вкладке "Детали процесса анализа".

### Архивация, восстановление и удаление группового анализа

Для ***архивации*** группового анализа наведите курсор на строку анализа на странице "Все анализы" и
нажмите на появившийся активный элемент <img src={require('/img/rus/delete_btn.png').default} width="18"/>.
Анализ будет перемещен на страницу "**Архив**" из блока страниц "Групповой анализ". Перейдя на эту страницу, вы можете:

1. ***Восстановить*** групповой анализ, наведя курсор на строку анализа и нажав на появившийся активный
элемент <img src={require('/img/rus/restore_btn.png').default} width="22"/>.
Тогда анализ будет перемещен обратно на страницу "Все анализы".

2. ***Удалить*** групповой анализ, наведя курсор на строку анализа и нажав на появившийся активный
элемент <img src={require('/img/rus/delete_btn.png').default} width="18"/>.
Кроме того, вы можете удалить все архивированные групповые анализы,
нажав на <img src={require('/img/runs/clear_archive_btn.png').default} width="170"/>.
