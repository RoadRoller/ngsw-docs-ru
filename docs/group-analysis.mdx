---
sidebar_position: 11
sidebar_label: Групповой анализ
---

# Групповой анализ

Групповой анализ - объединение герминальных вариантов (SNVs/Indels),
выявленных в выбранных для анализа образцах. Он включает комбинирование, фильтрацию и аннотацию
герминальных вариантов образцов.
Доступные типы группового анализа:
- **Анализ герминальной когорты** используется для объединения и сравнения образцов, схожих по какому-либо признаку
(например, по типу патологии или источнику данных), или образцов больших семей, в которых секвенированы сиблинги.
В анализ можно включить максимально 25 образцов. Результаты анализа представлены в SNV Viewer со всеми вариантами,
выявленными в образцах, включенных в анализ.
- **Семейный анализ** подходит для объединения и сравнения образцов одной семьи (пробанд + один или два родителя
или два родителя без пробанда). Может включать 2 или 3 образца. Результаты анализа представлены в SNV Viewer
со всеми вариантами, выявленными в образцах, включенных в анализ. В SNV Viewer есть специализированные фильтры,
основанные на генотипах членов семьи.
- **Популяционный анализ** направлен на изучение распределения частот аллелей в некоторой популяции.
Он может включать неограниченное количество образцов. Результаты анализа представлены в виде файла VCF с
частотами аллелей вариантов, выявленных в образцах, включенных в анализ.

Чтобы открыть страницу с групповыми анализами, перейдите на страницу "**Все анализы**" из блока
страниц "**Групповой анализ**" через панель навигации слева:

<p align="center">
<img src={require('/img/group_analysis/group_analysis_page.png').default} width="900"/>
</p>

### Создание группового анализа {#add-group-analysis}

Для перехода к форме создания группового анализа нажмите
на <img src={require('/img/rus/add_group_analysis_btn.png').default} width="150"/>.
Другим путем создания группового анализа является [объединение когорты](/cohorts#cohort-analysis).

В открывшейся форме введите название группового анализа в поле **Имя**.
Здесь же вы также можете добавить описание анализа.

<p align="center">
<img src={require('/img/group_analysis/create_group_analysis.png').default} height="600"/>
</p>

#### Настройки анализа {#analysis-preset}

Если вы хотите использовать вашу [предустановку настроек](/settings/settings/settings) параметров фильтрации
герминальных SNVs/Indels,
выберите её в выпадающем списке "*Предварительной установки настроек*". Обратите внимание, что на ход
группового анализа может повлиять только такая предустановка, которая настраивает
параметры фильтрации герминальных SNVs/Indels. Если выбранные по умолчанию параметры фильтрации вас устраивают,
оставьте для анализа предустановку, выбранную по дефолту.

#### Тип анализа {#analysis-type}

Доступные типы группового анализа описаны выше. Это может быть анализ *герминальной когорты*, *семейный* анализ
или *популяционный* анализ. Выберите нужный тип анализа, нажав на соответствующий контейнер,
а затем<br></br>нажмите <img src={require('/img/group_analysis/go_on_btn.png').default} width="130"/>,
чтобы перейти к выбору образцов для анализа.

#### Образцы для анализа {#samples-for-analysis}

Таблица с образцами, доступными для анализа, включает
название образца и код пациента или название запуска, к которому он относится. Образец неопухолевой ткани
обозначен как <img src={require('/img/rus/normal_success.png').default} width="20"/>, образец
опухолевой ткани - <img src={require('/img/rus/tumor_success.png').default} width="20"/>.
Для группового анализа доступны только образцы,
загруженные в формате FASTQ или BAM, для которых были успешно завершены стадии выявления
и аннотации герминальных SNVs/Indels и которые принадлежат пациенту или запуску, не находящемуся в "Архиве".

<p align="center">
<img src={require('/img/group_analysis/select_samples.png').default} height="600"/>
</p>

Отметьте галочками те образцы (минимум два), для которых вы хотите провести анализ.
В анализ герминальной когорты можно включить максимум 25 образцов, в семейный анализ - 3, в популяционный -
неограниченное количество.

#### Настройки семейного анализа {#family-analysis}

Если вы выбрали семейный тип группового анализа,
нажмите на <img src={require('/img/group_analysis/go_on_btn.png').default} width="130"/>
после выбора образцов для анализа. Вы перейдете на страницу настроек семейного анализа:

<p align="center">
<img src={require('/img/group_analysis/family_settings.png').default} width="600"/>
</p>

Определите для каждого образца "семейную роль" пациента, у которого он был взят: Пробанд (ребёнок), Отец или Мать:

<p align="center">
<img src={require('/img/group_analysis/family_analysis.png').default} width="600"/>
</p>

#### Запуск анализа {#run-analysis}

Для запуска анализа нажмите <img src={require('/img/rus/create_btn.png').default} width="130"/>.

### Страница группового анализа {#group-analysis-page}

После старта анализа вы попадете на его страницу (вкладка "**Главное**"):

<p align="center">
<img src={require('/img/group_analysis/ga_page.png').default} width="900"/>
</p>

На странице отображена информация о процессе анализа и об анализе. Когда анализ будет успешно завершен,
здесь появятся основные результаты.

#### Информация о групповом анализе {#group-analysis-info}

Справа на странице отображена основная информация об анализе:

<p align="center">
<img src={require('/img/group_analysis/ga_info.png').default} width="900"/>
</p>

- ИМЯ - название группового анализа. Можно поменять, нажав на поле значения.
- СОЗДАН - дата создания группового анализа в формате м/д/гггг.
- ТИП АНАЛИЗА - Герминальная когорта, Семейный или Популяционный. Типы "Семейный" и "Герминальная когорта"
можно сменять между собой, нажав на поле значение и выбрав другой
тип анализа (если образцы, используемые для анализа, не были удалены).
- ОБРАЗЦЫ - список образцов, для которых проводился анализ. Нажав на название образца, можно
открыть [его страницу](/results/results).
Если проводился семейный анализ, для каждого образца будет также указана выбранная "семейная роль" пациента,
у которого он был взят:

<p align="center">
<img src={require('/img/group_analysis/family_roles.png').default} width="150"/>
</p>

- КОММЕНТАРИИ - можно указать, нажав на поле значения.

### Процесс анализа {#workflow}

На вкладке "Главное" страницы группового анализа представлен раздел с информацией о процессе анализа.
Раздел представляет собой таблицу со стадиями анализа и их статусами:

<p align="center">
<img src={require('/img/group_analysis/workflow.png').default} width="900"/>
</p>

- Если стадия находится в процессе выполнения, то в её статусе есть
значок <img src={require('/img/results/in_process.png').default} width="22"/> и процентое
значение прогресса её выполнения.
- Если стадия завершена успешно, то она
имеет статус <img src={require('/img/results/complete.png').default} width="100"/>.
- Если стадия завершена с ошибкой, то в её статусе есть
значок <img src={require('/img/results/failed.png').default} width="25"/> и указана конкретная задача, на которой
анализ прекратился. В таком случае можно сообщить о возникшей проблеме администратору, нажав
на <img src={require('/img/results/report_a_problem.png').default} width="25"/>, или
попробовать повторить выполнение задачи, нажав на <img src={require('/img/results/try_again.png').default} width="22"/>.
- Если ещё не выполнены предыдующие шаги анализа, то стадия находится в статусе "*Не начато*".

Для каждой стадии можно посмотреть её детали, нажав
на <img src={require('/img/results/show_details.png').default} width="25"/>. Тогда вы перейдете в раздел этой стадии
на вкладке "**Детали процесса анализа**". На этой вкладке для каждой стадии можно скачать файлы с результатами и
посмотреть технические детали, такие как вывод консоли и сообщение об ошибке при обработке, если такая возникла.

#### Стадии группового анализа: {#group-analysis-stages}

1. **Комбинирование герминальных SNVs/Indels:** слияние файлов gVCF, полученных в результате выявления
герминальных SNVs/Indels в образцах, с помощью
инструмента [GATK GenomicsDBImport](https://gatk.broadinstitute.org/hc/en-us/articles/5358869876891-GenomicsDBImport)
и совместное генотипирование образцов анализа с
помощью [GATK GenotypeGVCFs](https://gatk.broadinstitute.org/hc/en-us/articles/360037057852-GenotypeGVCFs);
2. **Фильтрация герминальных SNVs/Indels:** фильтрация вариантов с помощью
инструмента [GATK VariantFiltration](https://gatk.broadinstitute.org/hc/en-us/articles/360037434691-VariantFiltration)
на основе определенных критериев фильтрации, которые вы можете найти и поменять на вкладке "Параметры" на
странице группового анализа;
3. **Аннотация герминальных SNVs/Indels:** определение влияния вариантов на различные участки ДНК с помощью инструмента
[VEP](https://www.ensembl.org/info/docs/tools/vep/index.html) и набора инструментов, разработанного командой Genomenal;
4. **Сохранение проаннотированных вариантов для [SNV Viewer](/group-analysis#group-analysis-variant-viewer):**
стадии нет для популяционного анализа.

#### Перезапуск анализа {#restart-processing}

Если вы хотите перезапустить выполнение одной из завершенных стадий, наведите курсор мыши на строку стадии
и нажмите на появившийся элемент <img src={require('/img/results/try_again.png').default} width="20"/>.

Если вы хотите перезапустить анализ с самого начала (со стадии "Комбинирование герминальных SNVs/Indels"),
нажмите на кнопку <img src={require('/img/results/restart_analysis.png').default} width="180"/>.
Обратите внимание, что такая кнопка есть только у анализа, все стадии которого завершились успешно.

### Результаты анализа {#analysis-results}

После успешного завершения всех стадий анализа результаты появятся на странице группового анализа:

1. Секция "***Герминальные SNVs/Indels***" на вкладке "Главное" включает все основные результаты группового
анализа. Для анализа герминальной когорты и семейного анализа результаты выглядят так (включают SNV Viewer):

<p align="center">
<img src={require('/img/results/germline_snvs.png').default} width="800"/>
</p>

А для популяционного анализа результаты выглядят следующим образом (нет SNV Viewer):

<p align="center">
<img src={require('/img/group_analysis/population_analysis_results.png').default} width="800"/>
</p>

- **SNV Viewer** - встроенный модуль для просмотра и анализа вариантов. Подробно
описан [ниже](/group-analysis#group-analysis-variant-viewer). SNV Viewer не представлен для
популяционного анализа. Нажмите
на кнопку <img src={require('/img/results/vv_btn.png').default} width="120"/>, чтобы воспользоваться модулем.
- Текстовый файл в формате **CSV** (Comma-Separated Values) с проаннотированными вариантами. Чтобы скачать файл,
нажмите на <img src={require('/img/results/table_btn.png').default} width="90"/>.
- Файл в формате **[VCF 4.2 (Variant Call Format)](http://samtools.github.io/hts-specs/VCFv4.2.pdf)** с
проаннотированными вариантами.
Для анализа герминальной когорты и для семейного анализа
нажмите на <img src={require('/img/results/vcf_btn.png').default} width="45"/>, чтобы скачать файл.
Для популяционного анализа нажмите на <img src={require('/img/results/vcf_btn.png').default} width="45"/>,
чтобы открыть список с результатами:

<p align="center">
<img src={require('/img/group_analysis/population_vcfs.png').default} width="170"/>
</p>

1. *Частоты* - файл в формате VCF с частотами аллелей вариантов, выявленных в образцах, включенных в анализ.
2. *Аннотированный* - файл в формате VCF с проаннотированными вариантами.

- Проаннотированные варианты в **таблицах Google** (может быть показана только часть вариантов). Чтобы открыть таблицу,
нажмите на <img src={require('/img/results/google_btn.png').default} width="45"/>.
- **[Integrative Genomics Viewer (IGV)](https://software.broadinstitute.org/software/igv/)** - встроенный модуль
визуализации вариаций на геноме. Чтобы открыть модуль, нажмите
на <img src={require('/img/results/igv_btn.png').default} width="45"/>.

2. ***Отчёт по герминальным SNVs/Indels группы образцов*** на вкладке "Биоинформатический отчёт".
Отчёт включает информацию о количестве, позиции в геноме и представленности в базах данных герминальных
вариантов, оставшихся в результате анализа.
Подробное описание отчёта можно
посмотреть [здесь](/results/bioinformatic-report#snvs-report).
Чтобы экспортировать отчёт в формате PDF,
нажмите на кнопку <img src={require('/img/results/export_pdf.png').default} width="150"/>.

3. Результирующие файлы для каждой стадии анализа на вкладке "Детали процесса анализа".

#### SNV Viewer группового анализа {#group-analysis-variant-viewer}

SNV Viewer представлен только для анализа герминальной когорты и семейного анализа.
Он подробно описан в [соответствующем разделе](/results/main/snvs-indels/variant-viewer)
о SNV Viewer образца, однако SNV Viewer группового анализа имеет ряд особенностей:
1. **Колонки "Глубина (Альт/Реф)" и "GT" содержат данные всех образцов анализа**.
Для анализа герминальной когорты для каждой колонки приведено название образца, в котором
вариант имеет соответствующие глубину секвенирования и генотип (при наведении курсора на название колонки
можно увидеть полное название образца):

<p align="center">
<img src={require('/img/group_analysis/ga_gt.png').default} width="500"/>
</p>

Для семейного анализа образцы, в которых вариант имеет соответствующие глублину секвенирования и
генотип, обозначены "семейными ролями" пациентов, определенными пользователем (при наведении курсора
на название колонки можно увидеть название образца):

<p align="center">
<img src={require('/img/group_analysis/trio_gt.png').default} width="600"/>
</p>

2. **Базовый параметр фильтрации "Трио GT"** - фильтр вариантов по наследованию: *De novo* варианты,
Новые гомозиготы (гомозиготы по локусам у пробанда, которые гетерозиготны у родителей) или
Наследованные от одного родителя.
Доступен [по умолчанию](/settings/profile#basic-mode-filters) только
в семейном групповом анализе в случае Трио (Пробанд, Отец и Мать).
Чтобы отфильтровать варианты по наследованию, нажмите
на окно фильтрации <img src={require('/img/group_analysis/trio_gt_filter.png').default} width="150"/> и
в появившемся списке отметьте галочками нужные значения:

<p align="center">
<img src={require('/img/group_analysis/trio_gt_options.png').default} width="300"/>
</p>

Для сброса фильтра по наследованию нажмите на окно фильтрации, а
затем на <img src={require('/img/vv/clear_option.png').default} width="100"/>.

Фильтровать по наследованию вариантов можно и
в [режиме расширенного поиска вариантов](/results/main/snvs-indels/advanced-filtering),
воспользовавшись [фильтром "Trio GT (Genotype)"](/results/main/snvs-indels/advanced-filtering#common).

3. Отстутствуют колонка ["Тип мутации"](/results/main/snvs-indels/variant-viewer#columns-description),
базовый фильтр ["Тип мутации"](/results/main/snvs-indels/basic-filtering#origin) и соответствующая им колонка
фильтрации в режиме расширенного поиска вариантов ["Origin"](/results/main/snvs-indels/advanced-filtering#common),
так как все варианты в SNV Viewer группового анализа являются герминальными.
4. Нет кнопки [включения вариантов в отчёт](/results/main/snvs-indels/variant-viewer#include-to-report),
поскольку для группового анализа отчёты не строятся.
5. Для вариантов можно определить патогенность
только [самостоятельно](/results/main/snvs-indels/pathogenicity#manually-determined-pathogenicity)
или [по базе патогенности](/results/main/snvs-indels/pathogenicity#define-pathogenicity-by-base).
6. На странице детальной информации о варианте есть
только вкладки ["Аннотация"](/results/main/snvs-indels/snv-details-page#annotation-tab) и "Встречаемость".

### Архивация, восстановление и удаление группового анализа {#delete-group-analysis}

Для ***архивации группового анализа*** наведите курсор на строку анализа на странице "Все анализы" и
нажмите на появившийся активный элемент <img src={require('/img/rus/delete_btn.png').default} width="18"/>.
Анализ будет перемещен на страницу "**Архив**" из блока страниц "Групповой анализ". Перейдя на эту страницу, вы можете:

1. ***Восстановить групповой анализ***, наведя курсор на строку анализа и нажав на появившийся активный
элемент <img src={require('/img/rus/restore_btn.png').default} width="22"/>.
Тогда анализ будет перемещен обратно на страницу "Все анализы".

2. ***Удалить групповой анализ***, наведя курсор на строку анализа и нажав на появившийся активный
элемент <img src={require('/img/rus/delete_btn.png').default} width="18"/>.
Вы увидите окно подтверждения удаления анализа:

<p align="center">
<img src={require('/img/group_analysis/confirmation_delete.png').default} width="350"/>
</p>

Для подтверждения удаления анализа
нажмите <img src={require('/img/runs/confirm.png').default} width="150"/>.<br></br>Для
отмены удаления анализа нажмите <img src={require('/img/report_templates/cancel.png').default} width="150"/>
или вне окна подтверждения.

Кроме того, вы можете удалить все архивированные групповые анализы,
нажав на <img src={require('/img/runs/clear_archive_btn.png').default} width="170"/>.
