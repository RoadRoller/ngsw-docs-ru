---
sidebar_position: 10
sidebar_label: Пользовательские аннотации
---

# Пользовательские аннотации

Если вы хотите проаннотировать найденные варианты с использованием дополнительных данных, 
загрузите пользовательскую аннотацию, содержащую эти данные.

### Начало

Откройте страницу **Настройки** -> **Пользовательские аннотации** и нажмите на "**Загрузить из файла**":

<p align="center">
<img src={require('/img/custom-annot/main_page.png').default} width="950"/>
</p>

Вы можете задать имя и ввести описание загружаемой аннотации, нажав на "**-**" (по умолчанию именем аннотации станет название файла):

<p align="center">
<img src={require('/img/custom-annot/name.png').default} height="170"/>
</p>

### Загрузка файла

Загрузите файл аннотации в формате **VCF**, **CSV** или **TSV**.
Для этого перетащите файл в окно или нажмите на него, чтобы открыть диспетчер файлов:

<p align="center">
<img src={require('/img/custom-annot/uploading_window.png').default} width="450"/>
</p>

Укажите сборку референса аннотации (hg19 или hg38) для правильного аннотирования вариантов:

<p align="center">
<img src={require('/img/custom-annot/genome.png').default} width="350"/>
</p>

Сразу после загрузки вам будет доступен предпросмотр первых семи строк аннотации.

### Сопоставление колонок

Если вы загрузили файл аннотации ***в формате VCF***, то колонки, необходимые для аннотации,
(CHROM, POS, REF, ALT) определятся ***автоматически***.

Если вы загрузили файл аннотации ***в формате CSV или TSV***, то нужно ***определить колонки***, 
необходимые для аннотации:

<p align="center">
<img src={require('/img/custom-annot/main_columns.png').default} width="950"/>
</p>

- CHROMOSOME - колонка с названиями хромосомы, в которых расположены варианты.
- POSITION (1-BASED) - колонка со стартовыми позициями вариантов.
- REFERENCE - колонка с референсными аллелями вариантов.
- ALTERNATIVE - колонка с альтернативными аллелями вариантов.

Для этого для каждой колонки выберите соответствующую колонку из загруженной вами аннотации.
Например, в данном случае колонке "CHROMOSOME" соответствует колонка "chr" из аннотации:

<p align="center">
<img src={require('/img/custom-annot/chromosome_column.png').default} width="300"/>
</p>

### Добавление колонки аннотации

В загруженной аннотации выберите колонки с данными, которыми вы хотите аннотировать варианты.

Нажмите на <img src={require('/img/custom-annot/add_new_column.png').default} width="250"/>.
В открывшемся окне задайте имя колонке:

<p align="center">
<img src={require('/img/custom-annot/column_name.png').default} height="400"/>
</p>

Затем укажите выбранную колонку в файле.
Скажем, у нас есть данные с частотами вариантов в экзоме и мы хотим аннотировать найденные Genomenal
варианты с использованием этой информации. Для этого выберем соответствующую колонку в файле:

<p align="center">
<img src={require('/img/custom-annot/file_column.png').default} width="400"/>
</p>

Наконец, определите тип колонки: текстовый или числовой:

<p align="center">
<img src={require('/img/custom-annot/filed_type.png').default} width="400"/>
</p>

и нажмите "**ОК**".
Колонка аннотации будет добавлена:

<p align="center">
<img src={require('/img/custom-annot/added_column.png').default} width="340"/>
</p>

Колонку можно ***редактировать***, наведя на неё курсор и нажав на выделенную кнопку:

<p align="center">
<img src={require('/img/custom-annot/edit_column.png').default} width="330"/>
</p>

Колонку можно ***удалить***, наведя на на неё курсор и нажав на крестик:

<p align="center">
<img src={require('/img/custom-annot/delete_column.png').default} width="330"/>
</p>

Можно добавить несколько колонок аннотации. Для добавления ещё одной колонки снова нажмите на <img src={require('/img/custom-annot/add_new_column.png').default} width="250"/>.

### Запуск процесса обработки

Чтобы процесс обработки аннотации начался, нажмите на <img src={require('/img/custom-annot/start.png').default} width="200"/>.

:::info
Если вы пропустили один из обязательных шагов создания аннотации 
(загрузка файла, определение сборки референса файла, 
сопоставление колонок, необходимых для идентификации варианта, 
или добавление хотя бы одной колонки аннотации), то кнопка "**Запустить процесс обработки**"
будет неактивна. По файлу, не прошедшему обработку, аннотирование вариантов происходить не будет.
:::

Пока обработка аннотации находится в процессе, статус будет "**IN_PROGRESS**":

<p align="center">
<img src={require('/img/custom-annot/annotation_in_progress.png').default} width="900"/>
</p>

Успешно обработанная аннотация будет иметь статус "**SUCCESS**":

<p align="center">
<img src={require('/img/custom-annot/success_status.png').default} width="900"/>
</p>

или "**PROBLEMS**", если во время обработки возникли некритичные проблемы 
(подробнее о проблеме можно узнать ниже в разделе "Warnings"):

<p align="center">
<img src={require('/img/custom-annot/problems_status.png').default} width="900"/>
</p>

Обработка аннотации, подготовленной неправильно, завершится неудачно со статусом "**FAILED**"
(об источнике ошибки можно узнать ниже в разделе "Errors"):

<p align="center">
<img src={require('/img/custom-annot/failed_status.png').default} width="900"/>
</p>

В такой ситуации скорректируйте один из шагов подготовки аннотации (выберите верную сборку референса,
укажите правильный тип колонки аннотации) или выберите другой файл аннотации.

Чтобы вернуться к списку всех пользовательских аннотаций, нажмите на <img src={require('/img/custom-annot/back_btn.png').default} width="230"/>.

Значения колонок, выбранных для аннотации вариантов, будут находиться [на странице Variant Viewer](/results/variant-viewer/snv_details_panel#custom-annotation-sources) и 
в файле с вариантами, который можно скачать с главной страницы образца.

### Редактирование пользовательской аннотации

Если вы хотите отредактировать уже подготовленную аннотацию (добавить, удалить или отредактировать колонки аннотации,
поменять сборку рефересного генома или поменять выбор обязательных колонок), вы можете это сделать на странице
пользовательской аннотации. Для этого внесите необходимые изменения и нажмите "****":

img

:::info
Если вы хотите, чтобы только что созданная или отредактированная аннотация аннотировала варианты образца, 
для которого уже завершена стадия "", перезапустите процессинг образца или соответствующую стадию.
:::

### Удаление пользовательской аннотации

Вы можете удалить аннотацию, нажав на корзину в строке аннотации:

img

а затем на :

img

:::info
Данные удаленной аннотации сохранятся с пометкой "deleted" для вариантов, которые были аннотированы по ней 
до её удаления:

img

:::
