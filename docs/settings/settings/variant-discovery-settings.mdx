---
sidebar_position: 4
sidebar_label: Настройки выявления вариантов
---

# Настройки выявления вариантов

### Фильтрация ПЦР дубликатов {#pcr-duplicates-filtration}

После стадии выравнивания результаты подвергаются нескольким этапам дополнительной
обработки. Это повышает чувствительность к низкочастотным вариантам, способствует более точному подсчету
количества копий, который зависит от количества прочтений, а также ускоряет обработку образца.
Если вы хотите сохранить все прочтения для дальнейшего анализа (например, если вы работаете с ампликонами),
то вы можете отключить фильтрацию.

#### Пометка дубликатов и её отключение {#disable-mark-duplicates}

В процессе секвенирования количество оригинальных последовательностей фрагментированной ДНК увеличивается
в полимеразной цепной реакции (ПЦР). Для дальнейшего анализа очень важно учесть дублирующиеся
прочтения одного и того же фрагмента. Пометка дубликатов выполняется с помощью инструмента
***[GATK MarkDuplicates](https://gatk.broadinstitute.org/hc/en-us/articles/360037052812-MarkDuplicates-Picard-)***.
Этот инструмент находит в файле выравнивания повторяющиеся прочтения, определяет, какие из прочтений происходят от
оригинальных последовательностей, а какие являются копиями (дубликатами), и помечает дубликаты.
Дальнейший анализ ведется только по оригинальным прочтениям. Для отключения пометки дубликатов выключите соответствующий
тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_mark_dupl.png').default} width="400"/>
</p>

#### Ограничение покрытия сайта для поиска вариантов и его отключение {#disable-limit-reads}

Увеличение количества прочтений, приходящихся на сайт для поиска герминальных вариантов, после определенного порога
(50 прочтений на сайт у GATK) приводит к необоснованным вычислительным тратам и может снижать чувствительность
к некоторым типам вариантов. Ограничение покрытия сайта прочтения выполняется опцией
```--max-reads-per-alignment-start``` инструмента для поиска герминальных вариантов
***[GATK HaplotypeCaller](https://gatk.broadinstitute.org/hc/en-us/articles/360037225632-HaplotypeCaller)***,
благодаря которой "лишние" прочтения случайным образом выбрасываются из анализа при превышении порога
на количество прочтений (50 прочтений). Для отключения ограничения покрытия сайта выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_recalibr.png').default} width="400"/>
</p>

:::note На заметку
Данная опция влияет только на поиск герминальных вариантов.
:::

#### Использование мягко отсекаемых оснований для поиска вариантов и его отключение {#soft-clipped-bases}

Мягко отсекаемые основания (soft clipped bases) - это основания, которые находятся на 3' и 5' концах
прочтения и не совпадают с референсной последовательностью. Они не включаются в выравнивание, однако,
в отличие от жёстко отсекаемых оснований (hard clipped bases), они не отбрасываются на этапе выравнивания
и учитываются инструментом ***[GATK Mutect2](https://gatk.broadinstitute.org/hc/en-us/articles/360037593851-Mutect2)***
при поиске соматических SNVs/Indels.
Хотя при использовании мягко отсекаемых оснований есть вероятность получить ложноположительный результат,
их отбрасывание из анализа не рекомендуется, поскольку зачастую именно мягко отсекаемые основания являются
единственным свидетельством настоящих инделов. Если множественные прочтения мягко отсекаются в одном и том же
месте, это может говорить о структурной вариации.

Отключение этой функции рекомендовано только в ситуации, когда на одной из предыдущих стадий анализа
основания, которые нужно было жёстко отсечь, были отсечены мягко.
Для исключения мягко отсекаемых оснований из анализа включите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/soft_clipped_bases.png').default} width="400"/>
</p>

:::note На заметку
Данная опция влияет только на поиск соматических вариантов.
:::

### Фильтрация SNVs/Indels {#snvs-filtration}

#### Фильтрация по capture kit и её отключение {#filter-snvs-by-capture-kit}

Как правило, для образцов, полученных в результате таргетного секвенирования, поиск вариантов проводится в тех же
геномных интервалах, в которых проводилось секвенирование. Таким образом, если для образца был определен
capture kit, то сначала с помощью
инструмента ***[bedtools intersect](https://bedtools.readthedocs.io/en/latest/content/tools/intersect.html)***
мы получаем интервалы пересечения этого capture kit с референсным геномом, а затем в этих интервалах осуществляется
поиск герминальных
(с помощью ***[GATK HaplotypeCaller](https://gatk.broadinstitute.org/hc/en-us/articles/360037225632-HaplotypeCaller)***)
или соматических (с помощью
***[GATK Mutect2](https://gatk.broadinstitute.org/hc/en-us/articles/360036713131-Mutect2)***) вариантов.
Файл с интервалами указывается параметром ```-L``` (```--intervals```).
Для отключения фильтрации по capture kit выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_filter_by_ck.png').default} width="400"/>
</p>

#### Отбрасывание вариантов, не прошедших фильтрацию, и его отключение {#allow-filtered-variants}

Выявленные коллером варианты обязательно проходят через стадию фильтрации, во время которой проверяется,
удовлетворяет ли вариант порогам параметров фильтрации. В результате в поле FILTER аннотации проставляется
значение "PASS", если вариант удовлетворяет всем параметрам фильтрации, или
указывается тот параметр, порогу которого вариант не удовлетворяет. По умолчанию только варианты, прошедшие
все фильтры, участвуют в дальнейшем анализе и отображаются в SNV Viewer. Вы можете отключить эту опцию -
тогда в SNV Viewer и статистике Биоинформатического отчёта будут отображаться все варианты.
Для этого выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_filtering.png').default} width="400"/>
</p>

:::note На заметку
Данная опция влияет только на отображение не прошедших фильтрацию вариантов в SNV Viewer и
Биоинформатическом отчёте.
В дальнейшем анализе (например, в групповом) всё равно будут участвовать только фильтрованные варианты.
:::

### Выявление соматических SNVs/Indels {#somatic-snvs-discovery}

Соматические мутации являются приобретенными и характерны для опухолевого процесса. Соответственно, выявление
таких мутаций проводится только в образцах опухолевой ткани с использованием контроля (соответствующей
неопухолевой ткани того же человека) или без контроля. Выявление соматических однонуклеотидных вариантов
(single-nucleotide variants; SNVs) и коротких инсерций/делеций (indels) происходит с помощью
инструмента ***[GATK Mutect2](https://gatk.broadinstitute.org/hc/en-us/articles/360037593851-Mutect2)***,
который работает в первую очередь путем сопоставления вариантов в опухоли и контроле (режим tumor-normal).
Он также работает и для поиска вариантов в опухоли без контроля (режим tumor-only), но такой поиск
отличается высоким уровнем ложных срабатываний (false positives).

#### Отключение поиска соматических SNVs/Indels {#disable-somatic-snvs-discovery}

Для отключения поиска соматических SNVs/Indels выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_somatic.png').default} width="400"/>
</p>

#### Выбор нормальной панели {#panel-of-normal}

Нормальная панель (Panel of Normal; PON) - панель, полученная из образцов здоровой ткани (то есть ткани, не имеющей
соматических мутаций) для захвата повторяющихся технических артефактов с целью улучшения результатов
выявления соматических вариантов. При этом образцы здоровой ткани, на которых строится
панель, должны быть получены с помощью секвенирования со схожими техническими характеристиками, такими как тип
секвенирования, секвенатор, реагент Capture Kit и т.д. Таким образом, при выборе PON, подходящей для ваших данных,
необходимо руководствоваться техническими характеристиками секвенирования образца опухолевой ткани. Чем
точнее подобрана панель, тем более специфичным становится анализ и может быть выявлено больше вариантов.
Панель предоставляется инструменту
***[GATK Mutect2](https://gatk.broadinstitute.org/hc/en-us/articles/360037593851-Mutect2)***
с помощью параметра ```--panel-of-normals``` (```-pon```).
Для выбора доступны следующие нормальные панели:

- *Basic panel of normals* - панель, полученная из 110 образцов, случайно выбранных из 181 образца здоровой ткани
человека. Панель показала самые высокие значения чувствительности и специфичности по сравнению с другими панелями
при выявлении соматических SNVs/Indels в образце из золотого стандарта (образец секвенирования рака молочной железы
SRR7890918 и образец крови SRR7890919). Выбрана по умолчанию.
- *Optimized for NimbleGen SeqCap_EZ_Exome_v2 & Illumina HiSeq 2000* - панель, полученная для 30 образцов секвенирования
на платформе Illumina HiSeq 2000 с реагентом Capture Kit NimbleGen SeqCap_EZ_Exome_v2.
- *Optimized for Agilent SureSelect_All_Exon_V2 & Illumina Genome Analyzer II* - панель, полученная для 30 образцов
секвенирования на платформе Illumina Genome Analyzer II с реагентом Capture Kit Agilent SureSelect_All_Exon_V2.
- *Optimized for Agilent SureSelect_All_Exon_V2 & Illumina HiSeq 2000* - панель, полученная для 30 образцов
секвенирования на платформе Illumina HiSeq 2000 с реагентом Capture Kit Agilent SureSelect_All_Exon_V2.
- *Optimized for Agilent SureSelect All Exon V4 & Illumina HiSeq 2000* - панель, полученная для 30 образцов
секвенирования на платформе Illumina HiSeq 2000 с реагентом Capture Kit Agilent SureSelect All Exon V4.
- *None* - выберите эту опцию, если хотите провести выявление соматических SNVs/Indels без нормальной панели.

Для смены нормальной панели для выявления соматических SNVs/Indels нажмите на значение поля "Panel of normals"
и выберите нужную панель:

<p align="center">
<img src={require('/img/rus/change_pon.png').default} width="400"/>
</p>

#### Отключение поиска соматических SNVs/Indels у одиночного образца опухолевой ткани {#disable-somatic-tumor-only-discovery}

Для отключения поиска соматических SNVs/Indels у одиночного образца опухолевой ткани (режим tumor-only)
выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_tumor_only.png').default} width="400"/>
</p>

:::note На заметку
Отключение не затрагивает пайплайн анализа наборов образцов, включающих образец неопухолевой ткани (normal).
:::

### Выявление герминальных SNVs/Indels {#germline-snvs-discovery}

Герминальные мутации являются наследуемыми и могут быть обнаружены в любых клетках организма. Выявляние таких
мутаций проводится для одиночных образцов опухолевой ткани без контроля и для образцов неопухолевой ткани.
Выявление герминальных однонуклеотидных вариантов
(single-nucleotide variants; SNVs) и коротких инсерций/делеций (indels) происходит с помощью
инструмента ***[GATK HaplotypeCaller](https://gatk.broadinstitute.org/hc/en-us/articles/360037225632-HaplotypeCaller)***.

#### Отключение поиска герминальных SNVs/Indels {#disable-germline-snvs-discovery}

Для отключения поиска герминальных SNVs/Indels выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_germline.png').default} width="400"/>
</p>

#### Отключение поиска герминальных SNVs/Indels у одиночного образца опухолевой ткани {#disable-germline-tumor-only-discovery}

Для отключения поиска герминальных SNVs/Indels у одиночного образца опухолевой ткани
выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_germline_tumor.png').default} width="400"/>
</p>

:::note На заметку
Отключение не затрагивает пайплайн анализа наборов образцов, включающих образец неопухолевой ткани (normal).
:::

#### Настройка объединения фазовых групп {#pg-merge-distance}

Фазовая группа - это объединение гомозиготных вариантов, расположенных в пределах определенного геномного интервала
(окна размера N).

Для отключения объединения вариантов в фазовые группы выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/pg_off.png').default} width="400"/>
</p>

Чтобы настроить размеры геномного интервала, в пределах которого гомозиготы будут объединены в
фазовую группу, нажмите на текущее значение (размер окна N = 3 п.н. по умолчанию) и отредактируйте (минимальное
значение = 1, максимальное значение = 10).
Для сохранения изменений нажмите клавишу "Enter" или кликните левой кнопкой мыши в свободное место на странице.

#### Параметры хардфильтрации (hard filtering) герминальных SNVs/Indels {#hard-filtration}

<details>
<summary>Нажмите, чтобы прочитать о параметрах хардфильтрации и их порогах</summary>
<table>
  <tr>
   <td>Параметр фильтрации</td>
   <td>Описание параметра</td>
   <td>Значение порога параметра по умолчанию</td>
  </tr>
  <tr>
   <td>QD (<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360037592191-QualByDepth">QualByDepth</a>)</td>
   <td>Достоверность варианта (значение из поля QUAL), нормализованная по нефильтрованнной глубине аллеля (AD) варианта
   в выборке вариантов с генотипом, отличным от hom-ref (homozygous/reference; генотип, при котором оба аллеля
   являются референсными). Для фильтрации лучше использовать QD, а не QUAL или фильтрованную глубину (DP) напрямую.
   Поскольку каждое прочтение вносит небольшой вклад в оценку QUAL, варианты в областях
   с глубоким покрытием могут иметь искусственно завышенные оценки QUAL, создавая впечатление, что вызов (call)
   варианта подтверждается большим количеством доказательств, чем это есть на самом деле. Чтобы этого избежать,
   необходимо нормализовать достоверность вариантов по глубине, что дает более объективную картину того, насколько
   хорошо поддерживается вызов (call).</td>
   <td>QD &#60; 2</td>
  </tr>
  <tr>
   <td>QUAL (качество варианта)</td>
   <td>Вероятность существования (по шкале Phred) варианта в этом сайте с учетом данных секвенирования.
   </td>
   <td>QUAL &#60; 30</td>
  </tr>
  <tr>
   <td>SOR
   (<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360036361772-StrandOddsRatio">StrandOddsRatio</a>)</td>
   <td>Смещение цепей, оцененное с помощью симметричного теста отношения шансов. Смещение цепей - это тип
   смещения последовательности, при котором предпочтение отдается одной цепи ДНК перед другой, что может привести
   к неправильной оценке количества доказательств, наблюдаемых для одного аллеля по сравнению с другим.
   StrandOddsRatio оценивает наличие смещения между прямыми и обратными цепями для референсного или альтернативного
   аллеля (аллелей).</td>
   <td>SOR &#62; 3 для SNVs (выключен для indels)</td>
  </tr>
  <tr>
   <td>FS (<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360037592371-FisherStrand">FisherStrand</a>)</td>
   <td>Вероятность смещения цепей на сайте, оцененная с помощью точного критерия Фишера. Смещение цепей - это тип
   смещения последовательности, при котором предпочтение отдается одной цепи ДНК перед другой, что может привести
   к неправильной оценке количества доказательств, наблюдаемых для одного аллеля по сравнению с другим.
   FisherStrand определяет, существует ли смещение цепи между прямой и обратной цепями для референсного или
   альтернативного аллеля (то есть встречается ли альтернативный аллель чаще или реже на прямой или обратной цепи,
   чем референсный аллель). Результат FisherStrand представляет собой p-значение по
   шкале Phred. Чем выше это значение, тем больше вероятность смещения. Большее смещение свидетельствует о
   ложноположительных вызовах (false positive calls) вариантов. FisherStrand хуже учитывает большие объемы данных
   в ситуациях с высоким покрытием по сравнению с StrandOddsRatio. Кроме того, FisherStrand имеет тенденцию
   "штрафовать" варианты, которые встречаются на концах экзонов. Варианты на концах экзонов, как правило,
   покрываются прочтениями только в одном направлении цепи, и FisherStrand дает таким вариантам плохую оценку, тогда
   как StrandOddsRatio учитывает соотношение прочтений, охватывающих оба аллеля.</td>
   <td>FS &#62; 60 для SNVs,<br></br>FS &#62; 200 для indels</td>
  </tr>
  <tr>
   <td>MQ (<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360037591751-RMSMappingQuality">RMMSMappingQuality</a>)</td>
   <td>Среднеквадратичное значение качества сопоставления прочтений по всем образцам.
   Представляет собой оценку общего качества картирования прочтений, покрывающих сайт варианта, усредненную по всем
   образцам в когорте, т.е. квадратный корень среднего квадрата качества картирования сайта варианта. Таким образом,
   оценка учитывает стандартное отклонение качества картирования. Низкое стандратное отклонение означает, что все
   значения близки к среднему, тогда как высокое стандартное отклонение означает, что все значения далеки от среднего.
   Когда качество картирования на сайте хорошее, MQ будет около 60.</td>
   <td>MQ &#60; 40 для SNVs (выключен для indels)</td>
  </tr>
  <tr>
   <td>MQRankSum (<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360045799632-MappingQualityRankSumTest">MappingQualityRankSumTest</a>)</td>
   <td>Тест суммы рангов для сопоставления качества картирования прочтения REF и качества картирования прочтения ALT.
   MQRankSum на уровне варианта сравнивает качество картирования прочтений, поддерживающих референсный аллель, с
   прочтениями, поддерживающими альтернативный аллель. Наилучшим результатом является значение, близкое к нулю,
   что указывает на то, что разница практически отсутствует. Отрицательное значение указывает на то, что прочтения,
   поддерживающие альтернативный аллель, имеют более низкие показатели качества картирования, чем прочтения,
   поддерживающие референсный аллель, и наоборот: положительное значение указывает на то, что прочтения,
   поддерживающие альтернативный аллель, имеют более высокие показатели качества картирования, чем прочтения,
   поддерживающие референсный аллель. Обнаружение любой статистически значимой разницы в качестве
   предполагает, что процесс секвенирования и/или картирования мог быть искажен артефактом.
   На практике при оценке качества варианта отфильтровываются только низкие отрицательные значения, поскольку
   идея состоит в том, чтобы отфильтровать варианты, для которых качество данных, подтверждающих альтернативный
   аллель, сравнительно низкое. Обратный случай, когда качество данных, поддерживающих референсный аллель, ниже,
   не очень информативен для фильтрации вариантов.</td>
   <td>MQRankSum &#60; -12.5 для SNVs (выключен для indels)</td>
  </tr>
  <tr>
   <td>ReadPosRankSum (<a href="https://gatk.broadinstitute.org/hc/en-us/articles/360042914711-ReadPosRankSumTest">ReadPosRankSumTest</a>)</td>
   <td>Тест суммы рангов для относительных позиций аллелей REF и ALT в прочтениях.
   ReadPosRankSum на уровне варианта проверяет, различаются ли положения референсного и альтернативного
   аллеля в прочтениях, которые поддерживают вариант.
   Нахождение аллеля только вблизи концов прочтений указывает на ошибку, потому что именно там
   секвенаторы склонны делать больше всего ошибок. Однако некоторые варианты, расположенные вблизи
   краев областей секвенирования, обязательно будут перекрыты концами прочтений, поэтому нельзя
   просто установить абсолютный порог «минимального расстояния от конца считывания». Вот почему полезен
   тест суммы рангов, чтобы оценить, есть ли разница в том, насколько хорошо поддерживаются референсный и
   альтернативный аллели. Наилучшим результатом является значение, близкое к нулю, поскольку оно указывает
   на небольшую разницу между позициями референсного и альтернативного аллелей в прочтениях. Отрицательное
   значение говорит о том, что альтернативный аллель встречается на концах прочтений чаще, чем референсный
   аллель, и наоборот: положительное значение указывает на то, что референсный аллель встречается на концах
   прочтений чаще, чем альтернативный. Обнаружение статистически значимой разницы в относительном
   положении в любом случае указывает на то, что процесс секвенирования мог быть искажен артефактом.
   На практике при оценке качества варианта отфильтровываются только низкие отрицательные значения, поскольку
   идея состоит в том, чтобы отфильтровать варианты, для которых качество данных, подтверждающих альтернативный
   аллель, сравнительно низкое. Обратный случай, когда качество данных, поддерживающих эталонный аллель, ниже,
   не очень информативен для фильтрации вариантов.</td>
   <td>ReadPosRankSum &#60; -8 для SNVs;<br></br>ReadPosRankSum &#60; -20 для indels</td>
  </tr>
</table>
</details>

Если хотя бы один из параметров хардфильтрации варианта удовлетворяет установленному порогу,
то такой вариант не проходит фильтрацию.

#### Отключение или включение параметров хардфильтрации и изменение их порогов {#tweak-hard-filtration}

Чтобы ***изменить значение порога*** параметра хардфильтрации, нажмите на текущее значение и отредактируйте.
Для сохранения изменений нажмите клавишу "Enter" или кликните левой кнопкой мыши в свободное место на странице.

Чтобы ***отключить или включить параметр*** хардфильтрации, выключите или включите соответствующий тумблер. Включенный
тумблер имеет синий цвет и смещён вправо: <img src={require('/img/rus/toggle_on.png').default} width="35"/>, а
выключенный имеет серый цвет и смещён влево: <img src={require('/img/rus/toggle_off.png').default} width="35"/>.

#### Включение фильтрации герминальных SNVs/Indels с помощью CNN {#enable-cnn-scoring}

Помимо хардфильтрации для герминальных вариантов применяется фильтрация на основе оценок предварительно
обученной сверточной нейронной сети (convolutional neural network; CNN) 2D, реализованной
в ***[GATK CNNScoreVariants](https://gatk.broadinstitute.org/hc/en-us/articles/360037226672-CNNScoreVariants)***.
Фильтрация с помощью CNN занимает много времени и не вносит большой вклад в фильтрацию по сравнению с
хардфильтрацией. Подробнее о вкладке фильтрации с помощью CNN можно узнать [здесь](/benchmarking#filtration-impact).

Для включения фильтрации герминальных SNVs/Indels с помощью CNN модели включите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_on_cnn.png').default} width="400"/>
</p>

### Выявление структурных вариаций {#sv-discovery}

Структурные вариации (structural variation; SV) - длинные делеции, тандемные дупликации, инверсии и транслокации.
Выявляются с помощью инструмента ***Delly***[^1] - интегрированного метода прогнозирования геномных перестроек
по всему геному, который может выявлять, генотипировать и визуализировать структурные вариации с разрешением до
одного нуклеотида в данных массивно-параллельного секвенирования с короткими прочтениями. Для пары образцов
опухоль/контроль применяется пайплайн с нормальным образцом в качестве контроля. Для одиночного образца неопухолевой
ткани или одиночного образца опухолевой ткани применяется пайплайн без контрольного образца. При этом результатом
выявления структурных вариаций у одиночного образца опухолевой ткани является смесь соматических и герминальных SV
из-за отсутствия соответствующего контрольного образца.

#### Отключение поиска структурных вариаций {#disable-sv-discovery}

Для отключения поиска структурных вариаций у образца выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_structural.png').default} width="400"/>
</p>

### Выявление вариации числа копий {#cnv-discovery}

Вариация числа копий (copy number variation; CNV) - это явление, при котором в геноме наблюдается вариабельное
количество фрагментов ДНК. Длина таких фрагментов обычно колеблется от 1 тыс. до нескольких млн пар оснований.
CNV возникают в результате делеций и дупликаций и  делятся на две основные группы: уменьшение числа копий и
увеличение числа копий в геноме. Такие удаленные или дублированные фрагменты ДНК могут понизить или повысить
число копий определенного гена, что, в свою очередь, влияет на экспрессию продукта этого гена - белка или
некодирующей РНК. Вариации числа копий имеют большое значение при синдромах и раке. Выводы о количестве
копий делаются на основе различий в глубине секвенирования (количестве прочтений) данных секвенирования.
Выявление вариации числа копий происходит с помощью инструмента ***CNVkit***[^2], который умеет определять и
визулизировать число копий как в данных таргетного секвенирования, так и в данных полноэкзомного секвенирования.
Для пары образцов опухоль/контроль образец опухоли нормализуется по отношению к соответствующему контролю.
Для одиночных образцов опухолевой или неопухолевой ткани нормализация на основе контроля не применяется.
Также для одиночного образца опухолевой ткани вариации не разделяются на соматические и герминальные из-за
отсутствия соответствующего контрольного образца.

#### Отключение поиска вариации числа копий {#disable-cnv-discovery}

Для отключения поиска вариации числа копий у образца выключите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_cnv.png').default} width="400"/>
</p>

#### Порог вызова CNV {#cnv-call-threshold}

Пороговое значение log2FC, ниже которого вызывается одна аутосома вместо двух в норме.
log2FC - это логарифмическое соотношение выявленного числа копий к нормальному числу копий (равно двум
для аутосом и X-хромосомы в случае генотипа XX либо единице для половых хромосом в случае генотипа XY).
На основе выбранного порогового значения рассчитываются пороги для вызова CNV.
На примере значения порога по умолчанию (-0,7) разберём, какими будут пороги для вызова делеций и дупликаций
на аутосомах и половых хромосомах:
- Вариации числа копий на аутосомах с Log2FC ≤ -0.7 принимаются за делеции (то есть ниже этого порога вызывается
одна аутосома вместо двух в норме).
- Вариации числа копий на X- и Y-хромосомах с Log2FC ≤ -2.11 принимаются за делеции.
- Вариации числа копий на аутосомах с Log2FC ≥ 0.46 принимаются за дупликации. Порог для дупликации на
аутосоме рассчитывается по следующей формуле: *Log2FC = log<sub>2</sub>((2+D)/2)*, где *D* - "количество"
копийности, которое "теряется" при Log2FC=-0.7, а *2* - количество сестринских хроматид в аутосоме.
- Вариации числа копий на X- и Y-хромосомах с Log2FC ≥ 0.82 принимаются за дупликации.
- Вариации, не удовлетворяющие порогам, т.е. вариации на аутосомах с -0.7 < Log2FC < 0.46 и вариации на половых
хромосомах с -2.11 < Log2FC < 0.82, не проходят фильтрацию.

<details>
<summary>Нажмите, чтобы посмотреть, как производится расчёт порогов log2FC для делеций и дупликаций на аутосомах
и половых хромосомах</summary>
Порог вызова одной копии вместо двух на аутосомах вычисляется следующим
образом: <i>T<sub>21</sub> = log<sub>2</sub>(C/2)</i>,
где <i>C</i> - количество вызванных копий.<br/>Дельта числа копий: <i>D = 2 – C = 2 – 2 × 2<sup>T<sub>21</sub></sup></i>.<br/>
Тогда соответствующий порог вызова трёх копий вместо двух на аутосомах вычисляется
так: <i>T<sub>23</sub> = log<sub>2</sub>((2+D)/2) = log<sub>2</sub>(2-2<sup>T<sub>21</sub></sup>)</i>.<br/>
<b>Порог для вызова делеций на аутосомах:</b> <i>lo = T<sub>21</sub></i>.<br/>
<b>Порог для вызова дупликаций на аутосомах:</b> <i>hi = T<sub>23</sub></i>.<br/>
Для вычисления порога для вызова трёх копий вместо двух на Х-хромосоме нормализуем генотип XY, поделив его
на число копий, равное 1: <i>T<sub>23X</sub>= log<sub>2</sub>((2+D)/1) = log<sub>2</sub>(2+2-2×2<sup>T<sub>21</sub></sup>) = 1 + log<sub>2</sub>(2-2<sup>T<sub>21</sub></sup>) = 1 + T<sub>23</sub></i>.<br/>
<b>Вычисление порога для вызова дупликаций на X-хромосоме:</b><br/>
- если нет Y-хромосомы: <i>X<sub>hi</sub> = 1 + T<sub>23</sub></i>;<br/>
- если есть Y-хромосома: <i>X<sub>hi</sub> = log<sub>2</sub>(3-2×2<sup>T<sub>21</sub></sup>)</i>.<br/>
Порог для вызова одной копии вместо двух на Х-хромосоме: <i>T<sub>21X</sub> = log<sub>2</sub>((2-D)/1) = log<sub>2</sub>(2-2+2×2<sup>T<sub>21</sub></sup>) = 1 + T<sub>21</sub></i>.<br/>
Порог для вызова ни одной копии вместо одной на X-хромосоме: <i>T<sub>10X</sub> = log<sub>2</sub>((1-D)/1) = log<sub>2</sub>(1-2+2×2<sup>T<sub>21</sub></sup>) = log<sub>2</sub>(-1+2×2<sup>T<sub>21</sub></sup>)</i>.<br/>
<b>Вычисление порога для вызова делеций на X-хромосоме:</b><br/>
- если нет Y-хромосомы: <i>X<sub>lo</sub> = 1 + T<sub>21</sub></i>;<br/>
- если есть Y-хромосома: <i>X<sub>lo</sub> = log<sub>2</sub>(-1+2×2<sup>T<sub>21</sub></sup>)</i>.<br/>
Порог для вызова одной копии вместо ни одной на Y-хромосоме в случае генотипа
XX: <i>T<sub>01</sub> = log<sub>2</sub>((0+D)/1) = log<sub>2</sub>(2-2×2<sup>T<sub>21</sub></sup>) = log<sub>2</sub>(2×(1-2<sup>T<sub>21</sub></sup>)) =  1 + log<sub>2</sub>(1-2<sup>T<sub>21</sub></sup>)</i>.<br/>
<b>Вычисление порога для вызова дупликаций <i>Y<sub>hi</sub></i> и делеций <i>Y<sub>lo</sub></i> на Y-хромосоме:</b><br/>
- если нет Y-хромосомы: <i>Y<sub>hi</sub> = 1 + log<sub>2</sub>(1-2<sup>T<sub>21</sub></sup>))</i>; <i>Y<sub>lo</sub> = -∞</i>;<br/>
- если есть Y-хромосома: <i>Y<sub>hi</sub> = X<sub>hi</sub></i>; <i>Y<sub>lo</sub> = X<sub>lo</sub></i>.
</details>

#### Поиск только герминальных анеуплоидий {#germline-aneuploidies-only}

По умолчанию для образца неопухолевой ткани проводится поиск вариации числа копий как целых хромосом, так и
их плечей (q и p). Если вы хотите выявить только герминальные анеуплоидии (вариации числа копий хромосом),
включите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_on_aneuploidies.png').default} width="400"/>
</p>

#### Выбор панели референсных образцов для WGS {#wgs-reference-panel}

Анализ CNV более эффективен, когда для нормализации используется панель референсных образцов.
По умолчанию панель не выбрана (*None*, т.е. нормализация отключена). Для выбора доступны следующие панели:
- *BGI WGS* - панель на основе WGS образцов, которые секвенировались на BGI.
Панель рассчитана для бинов следующих размеров: 3000, 5000, 100000.
- *BGI WGS v2* - панель на основе WGS образцов, которые секвенировались на BGI.
Панель рассчитана для бина размером 3000.
- *WGA reference samples* - панель, которая позволяет проводить анализ CNV для результатов полногеномного
секвенирования с низким покрытием (low-pass WGS). Панель рассчитана для бинов следующих размеров: 100000,
300000, 500000, 1000000, 2000000, 5000000.

Для выбора панели нажмите на значение поля "*CNV analysis reference samples panel for WGS*" и выберите нужную панель:

<p align="center">
<img src={require('/img/rus/change_panel.png').default} width="450"/>
</p>

Если тип секвенирования образца автоматически определяется как направленный отбор, то выбранная референсная панель
CNV игнорируется.

#### Размер бина для WGS {#bin-size}

Бин (bin) - это интервал, в котором проводится подсчет количества прочтений. Если у вас данные с низким покрытием,
выбирайте высокие значения среднего размера бина (например, до 500,000 для low-pass WGS), а если данные с
высоким покрытием, то выбирайте низкие значения (например, 1000 для данных с покрытием 30X).
По умолчанию средний размер бина = 100,000. Чтобы его поменять, нажмите на текущее значение и
отредактируйте. Минимальное допустимое значение бина = 1000, максимальное = 5,000,000. Для сохранения изменений
нажмите клавишу "Enter" или кликните левой кнопкой мыши в свободное место
на странице. Если
вы [выбрали панель референсных образцов для WGS](/settings/settings/variant-discovery-settings#wgs-reference-panel),
то выберите размер бина, для которого она была рассчитана, из списка.

#### Выбор панели референсных образцов для направленного отбора {#targeted-capture-reference-panel}

Анализ CNV более эффективен, когда для нормализации используется панель референсных образцов.
Выбранная референсная панель CNV должна соответствовать реагенту capture kit, использованному для приготовления
анализируемого образца. По умолчанию панель не выбрана (*None*, т.е. нормализация отключена). Для выбора доступны
следующие панели:
- *SureSelect Human All Exon V6 r2* - панель для выявления CNV в образцах, полученных в результате таргетного
секвенирования с реагентом capture kit "SureSelect Human All Exon V6 r2".
- *TrusightOne v1.1* - панель для выявления CNV в образцах, полученных в результате таргетного
секвенирования с реагентом capture kit "TruSight One v1.1".

Все референсные панели CNV для направленного отбора рассчитаны только для одного разрешения, поэтому
на анализ не будет влиять [выбранный размер бина](/settings/settings/variant-discovery-settings#bin-size).

Для выбора панели нажмите на значение поля "*CNV analysis reference samples panel for Targeted capture*" и
выберите нужную панель:

<p align="center">
<img src={require('/img/rus/change_panel_targeted_capture.png').default} width="450"/>
</p>

Если тип секвенирования образца автоматически определяется как WGS, то выбранная референсная панель
CNV игнорируется.

### Предсказание фенотипов {#phenotype-prediction}

Предсказание фенотипов происходит по однонуклеотидным полиморфизмам (single nucleotide polymorphism; SNP),
ассоциированным с определенным проявлением признака согласно моделям, основанным на мультиномиальной логистической
регрессии (multinomial logistic regression; MLR). Мы используем модели, позволяющие предсказать такие
фенотипические признаки, как цвет волос, цвет глаз, цвет кожи, веснушчатость, непереносимость лактозы, группа
крови, метаболизм алкоголя, запах тела (подмышечный осмидроз), тип ушной серы, чувствительность рецепторов
к горькому вкусу, пол и фармакокинетика некоторых препаратов. Предсказание фенотипов можно провести для данных
генотипирования в формате GT или аннотированных герминальных SNVs/Indels в формате VCF.

#### Включение предсказания фенотипов {#enable-phenotype-prediction}

Для включения предсказания фенотипов у образца включите соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_on_phenotypes.png').default} width="400"/>
</p>

#### Отключение контроля качества и импутации {#disable-qc-and-imputation}

Пайплайн предсказания фенотипов включает три подготовительных шага перед самим предсказанием.
Первый - фильтрация SNP по качеству - осуществляется с помощью инструмента
***[PLINK](https://www.cog-genomics.org/plink/)***. Затем происходит импутация (определение негенотипированных
маркеров) c помощью ***[bcftools](https://samtools.github.io/bcftools/bcftools.html)*** и ***Beagle***[^3].
Импутация значительно увеличивает
количество маркеров, на основе которых будет происходить предсказание фенотипов. И в конце снова повторяется
фильтрация маркеров по качеству. Эти шаги важны для качества предсказания фенотипов, но не всегда завершаются
успешно для аннотированных вариантов в формате VCF. Для отключения контроля качества и импутации выключите
соответствующий тумблер:

<p align="center">
<img src={require('/img/rus/turn_off_qc.png').default} width="400"/>
</p>

[^1]: [Rausch T., Zichner T., Schlattl A. et al. DELLY: structural variant discovery by integrated paired-end and split-read analysis. Bioinformatics 28(18), i333:i339 (2012)](https://doi.org/10.1093/bioinformatics/bts378)
[^2]: [Talevich E., Shain A.H., Botton T., Bastian B.C. CNVkit: Genome-wide copy number detection and visualization from targeted sequencing. PLOS Computational Biology 12(4), e1004873 (2014)](https://doi.org/10.1371/journal.pcbi.1004873)
[^3]: [Browning B.L., Zhou Y., Browning S.R. A one-penny imputed genome from next generation reference panels. Am J Hum Genet 103(3), 338-348 (2018)](https://doi.org/10.1016/j.ajhg.2018.07.015)
