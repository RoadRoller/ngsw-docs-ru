---
sidebar_position: 2
sidebar_label: Настройки контроля качества
---

# Настройки контроля качества

Контроль качества - это важный первый шаг в анализе данных секвенирования. Он включает проверку
прочтений файла на соответствие критериям качества и, если проверка не была пройдена, очистку исходных данных
(тримминг и/или фильтрацию). Проверка прочтений производится с помощью инструмента ***Falco***, который работает
в среднем в три раза быстрее, чем эквивалентный инструмент FastQC[^1]. Тримминг прочтений производится с помощью
инструмента ***Cutadapt***, который находит и удаляет последовательности адаптеров, праймеры, поли(А)-хвосты и
другие типы нежелательных последовательностей из прочтений[^2]. Фильтрация прочтений производится с помощью
инструмента ***FASTX-Toolkit Quality Filter*** из набора
инструментов [FASTX-Toolkit](http://hannonlab.cshl.edu/fastx_toolkit/), который отфильтровывает
прочтения, основываясь на их качестве.

### Отключение контроля качества

Первичная проверка качества проводится для всех загружаемых в систему файлов и отключить её нельзя.
Отключить можно последующую очистку и повторную проверку качества. Для этого нужно выключить тумблер:

<p align="center">
<img src={require('/img/rus/tweaking_run_quality.png').default} width="400"/>
</p>

### Критерии оценки качества прочтений

<table>
  <tr>
   <td>Метрика</td>
   <td>Порог метрики</td>
   <td>Значение порога по умолчанию</td>
  </tr>
  <tr>
   <td>Число последовательностей</td>
   <td><b>Min Total Sequences</b> - минимальное количество последовательностей в файле. Если файл образца содержит
   меньше прочтений до или после очистки, то анализ образца автоматически прерывается.</td>
   <td>10,000</td>
  </tr>
  <tr>
   <td rowspan="2">Распределение длин прочтений</td>
   <td><b>Short Sequence Bound</b> - минимальная длина прочтений в файле. Прочтения, длина которых меньше значения
   порога, выбрасываются из дальнейшего анализа.</td>
   <td>20</td>
   </tr>
	<tr>
   <td><b>Max Short Sequences Percent</b> - максимальная доля коротких прочтений (в процентах) в файле.
   При превышении этого порога файл отмечается как не удовлетворяющий требованиям метрики.</td>
   <td>25</td>
  </tr>
  <tr>
   <td rowspan="2">Качество по плиткам (tiles)</td>
   <td><b>Max Tile Quality Deviation</b> - максимально допустимое отклонение качества плитки в файле. Плитки,
   качество которых отличается от среднего качества среди всех плиток на значение этого порога, не проходят
   по качеству.</td>
   <td>7</td>
   </tr>
	<tr>
   <td><b>Max Tile Bad Quality Cells</b> - максимально допустимое количество некачественных ячеек в плитке.
   При превышении этого порога проводится очистка по плиткам.</td>
   <td>10</td>
  </tr>
  <tr>
   <td rowspan="3">Качество по основаниям (нуклеотидам)</td>
   <td><b>Base Start Count</b> - количество оснований, которые представляют начало прочтения при проверке
   распределения качества во всех прочтениях.</td>
   <td>3</td>
   </tr>
	<tr>
   <td><b>Base End Count</b> - количество оснований, которые представляют конец прочтения при проверке
   распределения качества во всех прочтениях.</td>
   <td>3</td>
   </tr>
	<tr>
   <td><b>Min Base Percentile Quality</b> - минимально допустимое качество оснований в прочтении.
    При оценке рассматриваются отдельно начальные (в количестве, равном Base Start Count), конечные (в количестве,
    равном Base End Count) и средние основания. При превышении этого порога проводится тримминг или фильтрация
    прочтений в файле.</td>
   <td>20</td>
  </tr>
  <tr>
   <td>Перепредставленные последовательности</td>
   <td><b>Max Overrepresented Sequences Percent</b> - максимальная доля перепредставленных последовательностей
   (в процентах) в файле. При превышении этого порога файл отмечается как не удовлетворяющий требованиям
   метрики.</td>
   <td>1</td>
  </tr>
  <tr>
   <td>Загрязнение адаптерами</td>
   <td><b>Max Adapter Contaminated Percent</b> - максимальная доля прочтений, контаминированных адаптерными
   последовательностями, (в процентах). При превышении этого порога проводится тримминг адаптеров.</td>
   <td>1</td>
  </tr>
  <tr>
   <td>Содержание N
   </td>
   <td><b>Max N Content Percent</b> - максимальная доля неизвестных нуклеотидов N в любой позиции среди всех
   нуклеотидов в файле (в процентах). При превышении этого порога файл отмечается как не удовлетворяющий требованиям
   метрики.</td>
   <td>20</td>
  </tr>
  <tr>
   <td rowspan="3">Содержание GC</td>
   <td><b>Min Derivative Threshold</b> - минимальный порог для детекции локальных экстремумов (пиков) GC. При
   обнаружении вторичных пиков GC файл отмечается как не удовлетворяющий требованиям метрики. </td>
   <td>0.085</td>
   </tr>
	<tr>
   <td><b>Max Wave Sloping Threshold</b> - максимальный порог наклона пика GC. Превышение этого порога говорит
   о том, что в файле наблюдается нарушение содержания GC, и в таком случае файл отмечается как не удовлетворяющий
   требованиям метрики.</td>
   <td>0.035</td>
   </tr>
	<tr>
   <td><b>Min Wave Length</b> - минимально допустимая длина волны (расстояние между двумя пиками GC). Превышение
   этого порога говорит о том, что в файле наблюдается нарушение содержания GC, и в таком случае файл отмечается
   как не удовлетворяющий требованиям метрики.</td>
   <td>4</td>
  </tr>
  <tr>
   <td rowspan="5">Содержание основания в последовательности (соотношение AT/GC)</td>
   <td><b>Max Cutoff at End</b> - количество нуклеотидов с 3'-конца, которые не учитываются при оценке содержания
   GC.</td>
   <td>3</td>
   </tr>
	<tr>
   <td><b>Max Cutoff at Start</b> - количество нуклеотидов с 5'-конца, которые не учитываются при оценке содержания
   GC.</td>
   <td>15</td>
   </tr>
	<tr>
   <td><b>Cutoff Difference Percent</b> - порог разницы между спаренными основаниями (в процентах). Если разница между
   A и T или G и C превышает этот порог, то нуклеотиды на концах не учитываются.</td>
   <td>1</td>
   </tr>
	<tr>
   <td><b>Mean Difference Threshold</b> - порог среднего значения разницы между спаренными основаниями (в процентах).
   Если средняя разница между A и T или G и C превышает этот порог, то файл отмечается как не удовлетворяющий
   требованиям метрики.</td>
   <td>1</td>
   </tr>
	<tr>
   <td><b>Max Difference Threshold</b> - порог максимального значения разницы между спаренными основаниями (в
   процентах). Если в любой позиции разница между A и T или G и C отличается от максимума среди всех прочтений
   больше, чем на этот порог, то  файл отмечается как не удовлетворяющий требованиям метрики.</td>
   <td>20</td>
  </tr>
</table>

### Изменение порогов метрик

Чтобы изменить значение порога метрики, нажмите на текущее значение и отредактируйте. Для сохранения изменений нажмите
клавишу "Enter" или кликните левой кнопкой мыши в свободное место на странице.

[^1]: [de Sena Brandine G. and Smith A.D. Falco: high-speed FastQC emulation for quality control of sequencing data. F1000Research 2021, 8:1874 (2021)](https://doi.org/10.12688/f1000research.21142.2)
[^2]: [Martin M. Cutadapt Removes Adapter Sequences From High-Throughput Sequencing Reads. EMBnet.journal 17, 10:12 (2011)](https://doi.org/10.14806/ej.17.1.200)
