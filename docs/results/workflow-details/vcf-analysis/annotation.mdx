---
sidebar_position: 3
sidebar_label: Аннотация
---

# Аннотация

После успешной загрузки, идентификации и проверки образец переходит к основной стадии анализа - аннотации.
Если в загруженной аннотации есть SNVs/Indels, то запустится стадия "Аннотация герминальных SNVs/Indels" (если
образец был загружен как образец неопухолевой ткани) или "Аннотация соматических SNVs/Indels" (если образец
был загружен как образец опухолевой ткани). Если же в загруженной аннотации не обнаружены SNVs/Indels,
но есть структурные вариации, то запустится стадия "Аннотация герминальных структурных вариаций" (если
образец был загружен как образец неопухолевой ткани) или "Аннотация соматических структурных вариаций" (если
образец был загружен как образец опухолевой ткани).
При ошибке выполнения любой из перечисленных ниже задач анализ образца останавливается.

<p align="center">
<img src={require('/img/rus/vcf_annotation.png').default} width="1000"/>
</p>

**Задачи стадии "Аннотация SNVs/Indels":**
1. **Унификация SNVs/Indels**:
- Сортировка файла VCF с
помощью [GNU sort](https://www.gnu.org/software/coreutils/manual/html_node/sort-invocation.html) по словарю
c названиями хромосом.
- Модификация заголовка файла и изменение названий образцов
с помощью [bcftools reheader](https://samtools.github.io/bcftools/bcftools.html#reheader).
- Замена или исправление заголовка файла
с помощью [GATK FixVCFHeader](https://gatk.broadinstitute.org/hc/en-us/articles/360037428851-FixVcfHeader-Picard-).
- Проверка того, соответствуют ли референсные аллели в файле
референсной последовательности; разбивка мультиаллельных сайтов на биаллельные записи;
вывод только первой записи для дублирующихся строк
с помощью [bcftools norm](https://samtools.github.io/bcftools/bcftools.html#norm).
- Сжатие файла в GZIP архив с помощью [bgzip](http://www.htslib.org/doc/bgzip.html).
Получившийся файл можно скачать в разделе "*Файлы с результатами*" в деталях задачи "*Унификация SNVs/Indels*"
("*Скачать VCF_GZ*"). Также этот файл можно открыть в IGV, нажав на ссылку "*Открыть в IGV браузере*".
- Индексация файла с помощью [tabix](http://www.htslib.org/doc/tabix.html).
Получившийся индексный файл можно скачать в разделе "*Файлы с результатами*" в деталях
задачи "*Унификация SNVs/Indels*" ("*Скачать VCF_TBI*").

Если в анализ образца были включены вычисление полигенных рисков и/или предсказание фенотипов, то
после задачи "Унификация SNVs/Indels" начнется параллельное выполнение
стадии ["Предсказание фенотипов"](/results/workflow-details/vcf-analysis/phenotypes).

2. **Аннотация SNVs/Indels**:
- Аннотация SNVs/Indels в файле данными из баз [RefSeq](https://www.ncbi.nlm.nih.gov/refseq/),
[1000 Genomes](https://www.internationalgenome.org/), [dbNSFP](https://sites.google.com/site/jpopgen/dbNSFP),
[dbSNP](https://www.ncbi.nlm.nih.gov/snp/), [gnomAD](https://gnomad.broadinstitute.org/),
[ClinVar](https://preview.ncbi.nlm.nih.gov/clinvar/), [CADD](https://cadd.gs.washington.edu/),
[SpliceAI](https://spliceailookup.broadinstitute.org/), [ENIGMA](https://enigmaconsortium.org/).
- Определение влияния SNVs/Indels на гены, транскрипты, белковые последовательности и регуляторные
области с помощью [VEP](http://www.ensembl.org/info/docs/tools/vep/index.html), используя
алгоритм предсказания [PolyPhen](http://genetics.bwh.harvard.edu/pph2/) (результатом предсказания
для вариантов являются prediction и score) и [номенклатуру HGVS](https://varnomen.hgvs.org/).
В процессе также определяются канонический транскрипт гена,
номер аллеля из входных данных и номера затронутых вариантами экзонов и интронов. Невариантные строки
(где ALT пустой) остаются в итоговом файле.
Варианты определяются как upstream, если они расположены перед геном и расстояние между вариантом
и транскриптом больше 2000 п.о., и downstream, если варианты расположены после гена и расстояние между
вариантом и транскриптом больше 1000 п.о.<br></br>
Получившийся файл с сырыми аннотированными вариантами в формате TSV можно скачать в
разделе "*Файлы с результатами*" в деталях задачи "*Аннотация SNVs/Indels*" ("*Скачать Raw annotated TSV*").
Его также можно открыть в таблицах Google.<br></br>
Получившийся файл с аннотированными вариантами без дубликатов в формате TSV можно скачать в
разделе "*Файлы с результатами*" в деталях задачи "*Аннотация SNVs/Indels*" ("*Скачать All variants TSV*").
Его также можно открыть в таблицах Google.
Тот же файл, но в формате CSV можно скачать там же ("*Скачать All variants CSV*").
- Конвертация результатов в формате TSV в формат VCF.
- Замена или исправление заголовка файла VCF
с помощью [GATK FixVCFHeader](https://gatk.broadinstitute.org/hc/en-us/articles/360037428851-FixVcfHeader-Picard-).
- Сжатие файла VCF в GZIP архив с помощью [bgzip](http://www.htslib.org/doc/bgzip.html).
Получившийся файл можно скачать в разделе "*Файлы с результатами*" в деталях задачи "*Аннотация SNVs/Indels*"
("*Скачать All variants VCF_GZ*"). Также этот файл можно открыть в IGV, нажав на ссылку "*Открыть в IGV браузере*".
- Индексация файла VCF с помощью [tabix](http://www.htslib.org/doc/tabix.html).
Получившийся индексный файл можно скачать в разделе "*Файлы с результатами*" в деталях
задачи "*Аннотация SNVs/Indels*" ("*Скачать All variants VCF_TBI*").
- Вычисление статистики вариантов.
3. **Сохранение проаннотированных вариантов для SNV Viewer**: сохранение результатов
для показа во встроенном модуле для просмотра и анализа
вариантов [SNV Viewer](/results/main/snvs-indels/variant-viewer),
добавление информации о [встречаемости](/results/main/snvs-indels/snv-details-page#occurrences) варианта в
других образцах пользователя.

После стадии "Аннотация SNVs/Indels" анализ может
продолжиться [генерацией отчётов](/results/workflow-details/vcf-analysis/report_generation).

**Стадия "Аннотация структурных вариаций"** включает одну задачу **"Аннотация VCF со структурными вариациями"**:
- Фильтрация и аннотация структурных вариаций с помощью [AnnotSV](https://lbgi.fr/AnnotSV/).<br></br>
Получившийся файл со структурными вариациями в формате TSV можно скачать в
разделе "*Файлы с результатами*" в деталях задачи "*Аннотация VCF со структурными вариациями*"
("*Скачать Filtered variants TSV*"). Его также можно открыть в таблицах Google.
Тот же файл, но в формате CSV можно скачать там же ("*Скачать Filtered variants CSV*").
- Сжатие получившегося файла VCF в GZIP архив с помощью [bgzip](http://www.htslib.org/doc/bgzip.html).
Получившийся файл можно скачать в разделе "*Файлы с результатами*" в деталях
задачи "*Аннотация VCF со структурными вариациями*" ("*Скачать Filtered variants VCF_GZ*"). Также этот файл можно
открыть в IGV, нажав на ссылку "*Открыть в IGV браузере*".
- Индексация файла VCF с помощью [tabix](http://www.htslib.org/doc/tabix.html).
Получившийся индексный файл можно скачать в разделе "*Файлы с результатами*" в деталях
задачи "*Аннотация VCF со структурными вариациями*" ("*Скачать Filtered variants VCF_TBI*").

После стадии "Аннотация структурных вариаций" анализ образца заканчивается.

:::info На заметку
Если вы хотите добавить в вашу [десктопную версию IGV](https://igv.org/doc/desktop/) трек с вариантами или вариациями,
выявленными в результате анализа вашего образца в Genomenal, вы можете сделать это через ссылку.
Откройте детали нужной задачи ("*Унификация SNVs/Indels*", "*Аннотация SNVs/Indels*",
"*Аннотация VCF со структурными вариациями*") и сделайте следующее:
1. Нажмите правой кнопкой мыши на ссылку файла с вариантами (в зависимости от выбранной задачи это может быть ссылка
"*Скачать VCF_GZ*", "*Скачать All variants VCF_GZ*" или "*Скачать Filtered variants VCF_GZ*")
и выберите опцию "*Копировать адрес ссылки*".
2. Загрузите трек через URL в вашу десктопную версию IGV, как это
описано [здесь](https://igv.org/doc/desktop/#UserGuide/loading_data/).
3. Нажмите правой кнопкой мыши на ссылку для скачивания индексного файла, соответствующего файлу аннотации,
("*Скачать VCF_TBI*", "*Скачать All variants VCF_TBI*" или "*Скачать Filtered variants VCF_TBI*") и
выберите опцию "*Копировать адрес ссылки*".
4. Добавьте URL индексного файла в соответствующее поле в IGV.
5. Нажмите "*OK*". Готово! Трек с вариантами или вариациями, выявленными в образце, добавлен в IGV.
:::
