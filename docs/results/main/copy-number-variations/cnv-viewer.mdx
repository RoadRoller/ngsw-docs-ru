---
sidebar_position: 2
sidebar_label: CNV Viewer
---

# CNV Viewer

## Знакомство с CNV Viewer {#overview}

CNV Viewer - это встроенный модуль для просмотра и анализа вариаций числа копий (copy number variations; CNVs),
выявленных в образце. Доступен на главной странице образца (вкладка **[Главное](/results/main/main)**),
если для него успешно завершилась стадия "Выявление вариации числа копий".

На странице образца ***неопухолевой*** ткани представлен CNV Viewer с ***герминальными вариациями числа копий***,
выявленными у этого образца:

<p align="center">
<img src={require('/img/vv/germline_cnvv.png').default} width="780"/>
</p>

На странице образца ***опухолевой*** ткани из пары образцов ***опухоль/контроль***
может быть два CNV Viewer: с ***соматическими вариациями числа копий***,
выявленными у этого образца, и с ***герминальными вариациями числа копий***, выявленными
в контрольном образце:

<p align="center">
<img src={require('/img/vv/germline_and_somatic_cnvv.png').default} width="780"/>
</p>

На странице образца ***опухолевой*** ткани, анализировавшегося ***без контроля***,
представлен CNV Viewer c ***соматическими и герминальными вариациями числа копий***, выявленными у этого образца:

<p align="center">
<img src={require('/img/vv/germline_and_somatic_cnvv_tumor.png').default} width="780"/>
</p>

## Сегменты и бины {#segments-and-bins}

Нажав на кнопку <img src={require('/img/results/cnvv_btn.png').default} width="110"/>,
вы увидите две опции: "*Сегменты*" и "*Бины*", которые открывают CNV Viewer с
вариациями числа копий, выявленными в сегментах или бинах, соответственно:

<p align="center">
<img src={require('/img/results/cnvv_options.png').default} width="140"/>
</p>

:::info На заметку
Сегменты и бины - это интервалы, в которых проводится подсчёт количества прочтений.<br></br>
**Бины** - это небольшие интервалы, размер которых
регулируется [соответствующей настройкой](/settings/settings/variant-discovery-settings#minimal-bin-size) для WGS
и которые создаются в результате разделения референсного генома на интервалы равного размера.
Размер бина определяет разрешение выявления вариации числа копий.<br></br>
**Сегменты** - это крупные области генома, которые получаются в результате объединения соседних бинов
со схожей копийностью.<br></br>
Бины обеспечивают мелко раздробленный сигнал числа копий по всему геному без потери информации и дают
некоторый шум. Сегментация пытается удалить этот шум и определить местоположение дискретных вариаций
числа копий, т.е. отдельных областей, которые были продублированы или утеряны. Поэтому в первую очередь
рекомендуется анализировать сегменты, а прибегать к анализу бинов - для отображения уровня поддержки
каждого сегмента, а также для отслеживания потенциальных артефактов, таких как особенно зашумленных
областей генома. Однако стоит учесть, что некоторые выпадающие бины, которые отметаются сегментацией
как зашумлённость, могут оказаться реальными вариациями числа копий, равными по размеру этим бинам.
:::

## Основная страница {#main-page}

Выбрав одну из опций кнопки <img src={require('/img/results/cnvv_btn.png').default} width="110"/>:
"*Сегменты*" или "*Бины*", вы попадете на основную страницу CNV Viewer с
вариациями числа копий, выявленными в сегментах или бинах, соответственно.
Вверху справа будет отмечено, с какими вариациями открыта страница CNV Viewer:
- CNV Viewer с варициями числа копий, выявленными в сегментах образца неопухолевой ткани:

<p align="center">
<img src={require('/img/vv/normal_segments_vv.png').default} width="1000"/>
</p>

- CNV Viewer с варициями числа копий, выявленными в бинах образца неопухолевой ткани:

<p align="center">
<img src={require('/img/vv/normal_bins_cnvv.png').default} width="1000"/>
</p>

- CNV Viewer с варициями числа копий, выявленными в сегментах образца опухолевой ткани:

<p align="center">
<img src={require('/img/vv/tumor_segments_cnvv.png').default} width="1000"/>
</p>

- CNV Viewer с варициями числа копий, выявленными в бинах образца опухолевой ткани:

<p align="center">
<img src={require('/img/vv/tumor_bins_cnvv.png').default} width="1000"/>
</p>

Основным объектом CNV Viewer является таблица с вариациями числа копий - каждая вариация на новой строчке:

<p align="center">
<img src={require('/img/vv/cnv_row_full.png').default} width="1000"/>
</p>

### Общие и детальные строки {#full-and-split}

Для вариации числа копий есть два типа записи: **full** - участок целиком, и **split** - участок, разбитый по генам.
Каждому full-участку могут соответствовать несколько split-участков.
Записи full отображаются в CNV Viewer в виде **общих строк**, а записи split - в виде **детальных строк по генам**.
Вид строк зависит
от [режима представления таблицы CNV Viewer](/results/main/copy-number-variations/cnv-viewer#cnvv-mode).

### Режимы CNV Viewer {#cnvv-mode}

Для представления таблицы CNV Viewer существует два
режима: [древовидный режим](/results/main/copy-number-variations/cnv-viewer#tree-mode) и
[режим плоского списка](/results/main/copy-number-variations/cnv-viewer#list-mode).
Режимы сменяются кнопками переключателя в правом верхнем углу CNV
Viewer: <img src={require('/img/vv/tweak_modes.png').default} width="110"/>.

:::note На заметку
Выбранный режим и раскрытие общей строки в древовидном режиме (см. далее) сохраняются при выходе со
страницы CNV Viewer.
:::

#### Древовидный режим {#tree-mode}

По умолчанию CNV Viewer открывается в древовидном режиме. С этим режимом таблица грузится быстрее, поскольку
в нём детальные строки не показываются вместе с общими:

<p align="center">
<img src={require('/img/vv/tree_mode.png').default} width="1000"/>
</p>

Общую строку можно раскрыть, чтобы увидеть соответствующие детальные строки в этой позиции,
нажав на <img src={require('/img/vv/show_split.png').default} width="12"/> в общей строке
вариации. В строках, для которых нет соответствующих записей об участках, разбитых по генам, такой
кнопки нет. Раскрытая общая строка с её детальными строками выглядит следующим образом:

<p align="center">
<img src={require('/img/vv/split_rows.png').default} width="1000"/>
</p>

Здесь первая строка - общая, а ниже идут соответствующие детальные строки. Для возврата к таблице со
всеми общими строками без детальных
нажмите на <img src={require('/img/vv/return_to_full.png').default} width="20"/> в общей строке вариации.

Для перехода в древовидный режим
из [режима плоского списка](/results/main/copy-number-variations/cnv-viewer#list-mode) нажмите
на кнопку <img src={require('/img/vv/to_tree_mode.png').default} width="110"/> переключателя вверху страницы.

#### Режим плоского списка {#list-mode}

import Highlight from '@site/src/components/HighlightBlackText';

Для перехода в режим плоского списка из [древовидного](/results/main/copy-number-variations/cnv-viewer#tree-mode)
нажмите на кнопку <img src={require('/img/vv/to_list_mode.png').default} width="110"/> переключателя вверху страницы.
CNV Viewer работает медленнее в этом режиме, так как в нём отображаются не только общие строки,
но и детальные. При этом общие строки раскрашены <Highlight color="#F3F3F3">серым</Highlight>, а
детальные - белым и записаны под соответствующей общей строкой:

<p align="center">
<img src={require('/img/vv/list_mode.png').default} width="1000"/>
</p>

### Закрепление вариаций {#pin-variation}

Нужные вариации можно закрепить. На закрепленные вариации не
влияют [фильтрация и сортировка](/results/main/copy-number-variations/cnv-viewer#sort-and-filter)
всей таблицы вариаций, они всегда остаются вверху таблицы.
Между собой закрепленные вариации отсортированы по позиции.

Чтобы закрепить вариацию,
нажмите на <img src={require('/img/vv/pin_variant.png').default} width="28"/> в строке вариации.

В ***древовидном режиме*** закреплённая общая строка окажется вверху таблицы над остальными
незакреплёнными общими строками (строка подсвечена зелёным):

<p align="center">
<img src={require('/img/vv/pinned_variation.png').default} width="950"/>
</p>

При закреплении детальной строки происходит автоматическое закрепление и соответствующей общей строки.
При этом наверху таблицы сохраняется общая строка (она остаётся белой), а закреплённая детальная становится
над остальными незакреплёнными детальными строками. Между собой закреплённые детальные строки отсортированы
по названию гена.

<p align="center">
<img src={require('/img/vv/pinned_split.png').default} width="950"/>
</p>

В ***режиме плоского списка*** закреплённая общая строка также становится наверх таблицы (строка подсвечена зелёным).
При этом, если для общей строки есть соответствующие записи об участках, разбитых по генам, то её запись
дублируется в таблице над соответствующими детальными строками (дублирующаяся строка подсвечена серым, как остальные
общие строки, а кнопка закрепления имеет вид <img src={require('/img/vv/pin_full.png').default} width="28"/>).
При выделении одной из этих общих строк: закреплённой или дублирующей, обе строки подсветятся синим.

<p align="center">
<img src={require('/img/vv/double_pinned_full.png').default} width="950"/>
</p>

При закреплении детальной строки происходит автоматическое закрепление и соответствующей общей строки.
Обе строки перемещаются наверх таблицы и подсвечиваются зелёным. Если у этой общей строки остались ещё
незакреплённые соответствующие детальные строки, то она дублируется в таблице, как это описано выше.
Если же все детальные строки общей строки закреплены, то дублирующая строка не создаётся.

<p align="center">
<img src={require('/img/vv/pinned_full_and_split.png').default} width="950"/>
</p>

Чтобы открепить вариацию, нажмите на кнопку <img src={require('/img/vv/unpin.png').default} width="28"/>
в строке вариации (или на <img src={require('/img/vv/pin_full.png').default} width="28"/> в дублирующей общей строке).

:::note На заметку
Закрепление вариации сохраняется при выходе со страницы CNV Viewer.
:::

## Информация о вариации {#variation-information}

Помимо представленной в таблице информации (см.
[Описание колонок таблицы](/results/main/copy-number-variations/cnv-viewer#columns-description)), для каждой
вариации есть несколько встроенных модулей с дополнительной информацией:

1. **Панель детальной информации** о вариации. Чтобы увидеть панель, нажмите на строку вариации:

<p align="center">
<img src={require('/img/vv/details_panel_cnvv.png').default} width="950"/>
</p>

:::info На заметку
По умолчанию панель находится в развёрнутом состоянии внизу таблицы CNV Viewer. Если вы не пользуетесь
панелью на постоянной основе, то её можно скрыть из CNV Viewer
на [странице "Настройки пользователя"](/settings/profile#variant-details-bottom-panel).
:::

Подробнее о панели и её вкладках можно почитать
в [соответствующем разделе](/results/main/copy-number-variations/cnv-details-panel).

2. **Модуль визуализации вариации на геноме (IGV)**. Чтобы открыть встроенный модуль,
нажмите на <img src={require('/img/vv/igv_var.png').default} width="30"/> в строке вариации.
Из IGV, открытого из CNV Viewer, можно вернуться обратно в CNV Viewer с фильтром по позиции,
которая была открыта в IGV, нажав на кнопку <img src={require('/img/vv/back_to_cnvv.png').default} width="130"/>.
3. **Ссылка на позицию вариации в геномном браузере [Decipher](https://www.deciphergenomics.org/)**.
Чтобы перейти в браузер, нажмите на <img src={require('/img/vv/decipher.png').default} width="25"/> в строке вариации.

## Описание колонок таблицы {#columns-description}

Таблица CNV Viewer может включать следующие колонки:
1. **Позиция** - координаты вариации числа копий в геноме (хромосома + начальная позиция + конечная позиция).
Позицию вариации можно скопировать в буфер обмена. Для этого наведите курсор на значение
колонки и нажмите на <img src={require('/img/vv/copy.png').default} width="20"/>.
2. **Длина, кб** - длина участка вариации числа копий в килобазах.
3. **Гены** - для общих строк это количество генов, расположенных на затронутом участке вариации
числа копий, а для детальных строк это название расположенного на участке гена.
Название гена можно скопировать в буфер обмена. Для этого наведите курсор на значение
колонки и нажмите на <img src={require('/img/vv/copy.png').default} width="20"/>.
4. **Log2 FC** - логарифмическое соотношение выявленного числа копий к нормальному числу копий (равно двум
для аутосом и X-хромосомы в случае генотипа XX либо единице для половых хромосом в случае генотипа XY).
5. **Относительная копийнойсть** - количество копий некоторого участка на гаплоидный геном.
6. **Тип** - тип изменения числа копий: <img src={require('/img/vv/deletion.png').default} width="50"/> -
делеция, <img src={require('/img/vv/duplication.png').default} width="50"/> - дупликация.
7. **AF по когорте 180** - частота вариации в когорте, состоящей из 188 образцов. Значения частот
есть только для бинов размером 3000 или 5000. Колонка отображается только в CNV Viewer с варициями числа копий,
выявленными в бинах. Ячейки колонки раскрашены в зависимости от значения частоты:
- <Highlight color="#DEF1DB">зелёным</Highlight>, если AF ≥ 0.015;
- <Highlight color="#FFFAEB">жёлтым</Highlight>, если 0.01 ≤ AF &lt; 0.015;
- <Highlight color="#F9DAE0">красным</Highlight>, если AF &lt; 0.01.
8. **OMIM ID** - идентификатор гена, расположенного на затронутом участке вариации,
в базе [OMIM](https://www.omim.org/). Пишется только для детальных строк.
9. **Категория** - рейтинговая оценка патогенности вариации,
предоставляемая [AnnotSV](https://lbgi.fr/AnnotSV/Documentation/README.AnnotSV_latest.pdf) и
основанная на рекомендациях ACMG и ClinGen[^1].
Согласно рейтинговой оценке выставляется класс ACMG:
- Вариациям с рейтинговой оценкой ≥ 0.99 выставляется класс 5 - патогенные;
- Вариациям с рейтинговой оценкой от 0.90 до 0.98 выставляется класс 4 - вероятно патогенные;
- Вариациям с рейтинговой оценкой от 0.89 до −0.89 выставляется класс 3 - неопределенная значимость;
- Вариациям с рейтинговой оценкой от −0.90 до −0.98 выставляется класс 2 - вероятно доброкачественные;
- Вариациям с рейтинговой оценкой ≤ −0.99 выставляется класс 1 - доброкачественные.
10. **Класс ACMG** - патогенность вариации, выставляемая соответственно категории, определённой
[AnnotSV](https://lbgi.fr/AnnotSV/Documentation/README.AnnotSV_latest.pdf) (см. условия выше).
Значения колонки представлены
в виде значков:<br></br><img src={require('/img/vv/pathogenic.png').default} width="40"/> - Патогенная;<br></br><img src={require('/img/vv/probably_pathogenic.png').default} width="40"/> -
Вероятно патогенная;<br></br><img src={require('/img/vv/uncertain_significance.png').default} width="42"/> -
Неопределенная значимость;<br></br><img src={require('/img/vv/likely_benign.png').default} width="40"/> - Вероятно
доброкачественная;<br></br><img src={require('/img/vv/benign.png').default} width="40"/> -
Доброкачественная.<br></br>
При наведении курсора на значок можно посмотреть полное значение.
11. **Патогенность** - патогенность вариации, определяемая пользователем. Чтобы определить патогенность вариации,
нажмите на кнопку патогенности <img src={require('/img/vv/acmg_var_btn.png').default} width="42"/>
в строке вариации и в появившемся диалоге выберите нужную опцию:

<p align="center">
<img src={require('/img/vv/pathogenicity_list_cnvv.png').default} width="300"/>
</p>

:::info На заметку
Вариации с определенной патогенностью автоматически добавляются к выводам интерпретации образца.
:::

Возможные значения колонки представлены
в виде значков:<br></br><img src={require('/img/vv/acmg_var_btn.png').default} width="40"/> - Нет интерпретации
(до определения патогенности
вариации);<br></br><img src={require('/img/vv/pathogenic.png').default} width="40"/> - Патогенная;<br></br><img src={require('/img/vv/probably_pathogenic.png').default} width="40"/> -
Вероятно патогенная;<br></br><img src={require('/img/vv/uncertain_significance.png').default} width="42"/> -
Неопределенная значимость;<br></br><img src={require('/img/vv/likely_benign.png').default} width="40"/> - Вероятно
доброкачественная;<br></br><img src={require('/img/vv/benign.png').default} width="40"/> -
Доброкачественная.<br></br>
При наведении курсора на значок можно посмотреть полное значение.<br></br>
Патогенность можно переопределить в том же диалоговом окне или очистить, нажав на кнопку патогенности в строке
вариации и в появившемся диалоге выбрав опцию "*Очистить*":

<p align="center">
<img src={require('/img/vv/clear_on_dialog_cnvv.png').default} width="300"/>
</p>

При перезапуске стадии выявления вариации числа копий или более ранних стадий анализа образца
определенный класс патогенности вариации сохраняется, но требует подтверждения.
Кнопка патогенности, которую нужно подтвердить, обозначена
значком <img src={require('/img/vv/bell.png').default} width="18"/>.
Если вы согласны с классификацией варианта, нажмите на колокольчик или кнопку патогенности и в появившемся
диалоге выберите опцию "*Подтвердить патогенность*":

<p align="center">
<img src={require('/img/vv/confirm_pathogenicity_cnvv.png').default} width="300"/>
</p>

12. <b>P<sub>s</sub></b> - патогенные пересекающиеся варианты: установленные патогенные гены или геномные области,
полностью перекрывающиеся вариацией. Значения колонки представлены
в виде значков:<br></br><img src={require('/img/vv/gain.png').default} width="25"/> - Дупликация
(Gain);<br></br><img src={require('/img/vv/loss.png').default} width="25"/> - Делеция
(Loss);<br></br><img src={require('/img/vv/insertion.png').default} width="25"/> -
Инсерция или смешанное значение.<br></br>
При наведении курсора на значок можно посмотреть полное значение.
13. <b>B<sub>s</sub></b> - доброкачественные пересекающиеся варианты: установленные доброкачественные
геномные области, полностью перекрывающиеся вариацией. Значения колонки представлены
в виде значков:<br></br><img src={require('/img/vv/gain.png').default} width="25"/> - Дупликация
(Gain);<br></br><img src={require('/img/vv/loss.png').default} width="25"/> - Делеция
(Loss);<br></br><img src={require('/img/vv/inversion.png').default} width="25"/> -
Инверсия;<br></br><img src={require('/img/vv/insertion.png').default} width="25"/> -
Инсерция или смешанное значение.<br></br>
При наведении курсора на значок можно посмотреть полное значение.

## Поиск и сортировка вариаций {#sort-and-filter}

***Поиск вариаций*** в CNV Viewer
описан в [соответствующем разделе](/results/main/copy-number-variations/cnv-filtering).

По умолчанию таблица отсортирована по позиции вариации.
Таблицу можно ***сортировать*** по возрастанию или убыванию значений следующих колонок:
"*Позиция*", "*Длина, кб*", "*Гены*" (при этом в древовидном режиме сортировка общих строк происходит
по количеству генов и сортировка детальных строк - по названию гена, а в режиме плоского списка осуществляется
только сортировка общих строк по количеству генов, а сортировка детальных строк остаётся неизменной),
"*Log2 FC*", "*Относительная копийнойсть*", "*Тип*", "*AF по когорте 180*", "*OMIM ID*" (только в древовидном
режиме для детальных строк), "*Категория*", "*Класс ACMG*", "*Патогенность*".

Для сортировки таблицы по значениям колонки нажмите на её название (нажмите один раз, чтобы отсортировать
по возрастанию, или два раза, чтобы отсортировать по убыванию). После этого у названия колонки появится
стрелка вверх <img src={require('/img/vv/sort_asc.png').default} width="17"/> (при сортировке по возрастанию)
или вниз <img src={require('/img/vv/sort_desc.png').default} width="17"/> (при сортировке по убыванию).

Таблицу можно отсортировать по 1-3 колонкам одновременно, чтобы сгруппировать данные с одинаковыми
значениями в одной колонке, а затем отсортировать эти группы с одинаковыми значениями по другой колонке.
Порядок сортировки будет зависеть от порядка нажатия на названия соответствующих колонок.
Стрелочка сортировки будет у той колонки, по которой сортировали последней.

Для сброса сортировки возпользуйтесь кнопкой очистки всех
фильтров: <img src={require('/img/vv/clear_filters.png').default} width="35"/>. Обратите внимание, что
при этом сбросится и фильтрация вариаций.

Основным принципом сортировки является сортировка по алфавиту для колонок с текстовыми значениями (например,
колонка "Тип") или сортировка от минимального к максимальному и наоборот для колонок с числовыми
значениями (например, колонка "Длина, кб"). Однако для некоторых колонок сортировка особенная:
- Колонка "**Позиция**" - сортировка сначала по хромосоме, затем по позиции на ней.
- Колонки "**Класс ACMG**" и "**Патогенность**": сортировка от
патогенной к доброкачественной вариации: Патогенная, Вероятно патогенная, Неопределенная значимость,
Вероятно доброкачественная, Доброкачественная.

[^1]: [Riggs E.R., Andersen E.F., Cherry A.M. et al. Technical standards for the interpretation and reporting of constitutional copy number variants: a joint consensus recommendation of the American College of Medical Genetics and Genomics (ACMG) and the Clinical Genome Resource (ClinGen). Genet Med 22, 245-257 (2020)](https://doi.org/10.1038/s41436-019-0686-8)
